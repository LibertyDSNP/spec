<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Publishing - DSNP Specification</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 800) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <a id="logo" href="https://www.dsnp.org/">
                    DSNP
                </a>
                <ol class="chapter"><li class="chapter-item affix "><a href="../index.html">Introduction</a></li><li class="chapter-item affix "><a href="../Roadmap.html">Roadmap</a></li><li class="chapter-item "><a href="../DSNP/Overview.html">DSNP</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../DSNP/Identity.html">Identity</a></li><li class="chapter-item "><a href="../DSNP/Identifiers.html">Identifiers</a></li><li class="chapter-item "><a href="../DSNP/Graph.html">Graph</a></li><li class="chapter-item "><a href="../DSNP/BatchPublications.html">Batch Publications</a></li><li class="chapter-item "><a href="../DSNP/Announcements.html">Announcements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../DSNP/Types/Tombstone.html">Tombstone</a></li><li class="chapter-item "><a href="../DSNP/Types/GraphChange.html">Graph Change</a></li><li class="chapter-item "><a href="../DSNP/Types/Broadcast.html">Broadcast</a></li><li class="chapter-item "><a href="../DSNP/Types/Reply.html">Reply</a></li><li class="chapter-item "><a href="../DSNP/Types/Reaction.html">Reaction</a></li><li class="chapter-item "><a href="../DSNP/Types/Profile.html">Profile</a></li><li class="chapter-item "><a href="../DSNP/Types/Update.html">Update</a></li></ol></li><li class="chapter-item "><a href="../DSNP/Serializations.html">Serializations</a></li></ol></li><li class="chapter-item expanded "><a href="../Implementations.html">DSNP Implementation Specs</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Frequency/Overview.html">Frequency</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Frequency/Identity.html">Identity</a></li><li class="chapter-item expanded "><a href="../Frequency/Publishing.html" class="active">Publishing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Frequency/Validation.html">Validation</a></li></ol></li></ol></li><li class="chapter-item "><a href="../Ethereum/Overview.html">EVM (Deprecated)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Ethereum/Identity.html">Identity</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Ethereum/Identifiers.html">Identifiers</a></li><li class="chapter-item "><a href="../Ethereum/IdentityFactory.html">Factory</a></li><li class="chapter-item "><a href="../Ethereum/Registry.html">Registry</a></li></ol></li><li class="chapter-item "><a href="../Ethereum/Publishing.html">Publishing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Ethereum/Validation.html">Validation</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><a href="../ActivityContent/Overview.html">Activity Content</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ActivityContent/Types/Note.html">Note</a></li><li class="chapter-item "><a href="../ActivityContent/Types/Profile.html">Profile</a></li><li class="chapter-item "><div>Associated Type</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ActivityContent/Associated/Hash.html">Hash</a></li><li class="chapter-item "><a href="../ActivityContent/Associated/Location.html">Location</a></li><li class="chapter-item "><a href="../ActivityContent/Associated/Tag.html">Tag</a></li><li class="chapter-item "><a href="../ActivityContent/Associated/Attachments.html">Attachments</a></li></ol></li></ol></li><li class="chapter-item "><a href="../Reference/Glossary.html">Glossary</a></li><li class="chapter-item "><div>Draft Specifications</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Draft/Archivists.html">Archivists</a></li></ol></li></ol>
                <div class="spacer"></div>
                <a href="https://www.dsnp.org/developer-portal/" class="nav-return">↩ Developer Portal</a>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Dark</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">DSNP Specification</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/LibertyDSNP/spec" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/LibertyDSNP/spec/blob/main/pages/Frequency/Publishing.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Type to search..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="announcement-publishing"><a class="header" href="#announcement-publishing">Announcement Publishing</a></h1>
<p>On Frequency, <a href="../DSNP/Announcements.html">Announcements</a> are mapped to schemas which in turn publish Frequency Messages.
Frequency Messages are either direct Graph Changes from a particular user, or a Batch Publication with a multitude of users possible.</p>
<!-- Links to https://libertydsnp.github.io/frequency should be updated with links to docs.frequency.xyz when able to be -->
<div class="table-wrapper"><table><thead><tr><th>Announcement Type Enum</th><th>Announcement</th><th>Batched</th><th>Schema Id Mainnet</th><th>Schema Id Rococo</th><th>Frequency Model Type</th><th>Frequency Payload Location</th></tr></thead><tbody>
<tr><td>0</td><td><a href="../DSNP/Types/Tombstone.html">Tombstone</a></td><td>YES</td><td>TBD</td><td>TBD</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>1</td><td><a href="../DSNP/Types/GraphChange.html">Graph Change</a></td><td>no</td><td>TBD</td><td>TBD</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.AvroBinary"><code>AvroBinary</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.OnChain"><code>OnChain</code></a></td></tr>
<tr><td>2</td><td><a href="../DSNP/Types/Broadcast.html">Broadcast</a></td><td>YES</td><td>TBD</td><td>TBD</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>3</td><td><a href="../DSNP/Types/Reply.html">Reply</a></td><td>YES</td><td>TBD</td><td>TBD</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>4</td><td><a href="../DSNP/Types/Reaction.html">Reaction</a></td><td>YES</td><td>TBD</td><td>TBD</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>5</td><td><a href="../DSNP/Types/Profile.html">Profile</a></td><td>YES</td><td>TBD</td><td>TBD</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>6</td><td><a href="../DSNP/Types/Update.html">Update</a></td><td>YES</td><td>TBD</td><td>TBD</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
</tbody></table>
</div>
<p>Source code for each schema is also located in the <a href="https://github.com/LibertyDSNP/schemas">LibertyDSNP/schemas</a> repository.</p>
<h2 id="dsnp-non-batched-announcements"><a class="header" href="#dsnp-non-batched-announcements">DSNP Non-Batched Announcements</a></h2>
<p>Frequency uses an on-chain data structure for storage of <code>GraphChange</code> Announcements.
Each individual announcement is submitted using the <a href="https://libertydsnp.github.io/frequency/pallet_messages/pallet/enum.Call.html#variant.add_onchain_message"><code>add_onchain_message</code></a> extrinsic.</p>
<h2 id="dsnp-batched-announcements"><a class="header" href="#dsnp-batched-announcements">DSNP Batched Announcements</a></h2>
<p>Frequency uses <a href="../DSNP/BatchPublications.html">DSNP Batch Publications</a> for Announcements that are batched.
The parquet file is stored on <a href="https://ipfs.io/">IPFS</a>, but it is discovered through the Frequency Message.</p>
<p>Frequency Messages maintain the metadata of where and when the Batch Publication was published and which Provider MSA published it.
It is the publisher's responsibility to maintain the <a href="https://docs.ipfs.tech/concepts/glossary/#pinning">IPFS pin</a> so that the batch file is continuously available.</p>
<p>DSNP Batch Publications <a href="./Validation.html">MUST be validated</a> upon fetching to ensure data and permission integrity.</p>
<h2 id="ordering"><a class="header" href="#ordering">Ordering</a></h2>
<p>Frequency Messages are well ordered within a Schema</p>
<ol>
<li>Frequency: Block number ascending</li>
<li>Frequency: Block index ascending</li>
<li>DSNP Standard: Order Announcements in a Batch Publication File by row appearance order</li>
</ol>
<h3 id="ordering-across-schemas"><a class="header" href="#ordering-across-schemas">Ordering Across Schemas</a></h3>
<p>Frequency provides complete ordering metadata for Messages across Schemas.
Block index is unique per Message within the same block.</p>
<h3 id="human-order"><a class="header" href="#human-order">Human Order</a></h3>
<p>Due to the asynchronous nature of networks and batching, it is possible that the canonical ordering of Announcements is wrong from a human viewpoint.
With dependent Announcements, where one Announcement refers to another Announcement, the order may be inferred differently than the canonical ordering.
It is left to user interfaces to handle these situations.</p>
<h2 id="retrieval"><a class="header" href="#retrieval">Retrieval</a></h2>
<p>Frequency nodes provide an RPC interface <a href="https://libertydsnp.github.io/frequency/pallet_messages_rpc/trait.MessagesApiClient.html#method.get_messages_by_schema"><code>get_messages_by_schema</code></a> with paginated responses that differ based on the Schema.</p>
<p>Frequency nodes can provide a websocket interface that will emit an event for each block that has one or more messages of a given schema in that block.
The <a href="https://libertydsnp.github.io/frequency/pallet_messages/pallet/enum.Event.html#variant.MessagesStored"><code>MessagesStored</code></a> event can be used to know when to call the RPC interface to retrieve the messages.</p>
<p>See the <a href="https://libertydsnp.github.io/frequency/pallet_messages_rpc/trait.MessagesApiClient.html#method.get_messages_by_schema">Frequency Documentation</a> for more details on Message retrieval.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../Frequency/Identity.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../Frequency/Validation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../Frequency/Identity.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../Frequency/Validation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
