<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>DSNP Specification</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 800) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <a id="logo" href="https://www.dsnp.org/">
                    DSNP
                </a>
                <ol class="chapter"><li class="chapter-item affix "><a href="index.html">Introduction</a></li><li class="chapter-item "><a href="DSNP/Overview.html">DSNP</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="DSNP/Identity.html">Identity</a></li><li class="chapter-item "><a href="DSNP/Identifiers.html">Identifiers</a></li><li class="chapter-item "><a href="DSNP/Graph.html">Graph</a></li><li class="chapter-item "><a href="DSNP/UserData.html">User Data</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="DSNP/Types/GraphEdge.html">Graph Edge</a></li><li class="chapter-item "><a href="DSNP/Types/PRId.html">PRId</a></li></ol></li><li class="chapter-item "><a href="DSNP/BatchPublications.html">Batch Publications</a></li><li class="chapter-item "><a href="DSNP/Announcements.html">Announcements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="DSNP/Types/Tombstone.html">Tombstone</a></li><li class="chapter-item "><a href="DSNP/Types/Broadcast.html">Broadcast</a></li><li class="chapter-item "><a href="DSNP/Types/Reply.html">Reply</a></li><li class="chapter-item "><a href="DSNP/Types/Reaction.html">Reaction</a></li><li class="chapter-item "><a href="DSNP/Types/Profile.html">Profile</a></li><li class="chapter-item "><a href="DSNP/Types/Update.html">Update</a></li><li class="chapter-item "><a href="DSNP/Types/PublicKey.html">Public Key</a></li><li class="chapter-item "><a href="DSNP/Migrated.html">Migrated Announcements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="DSNP/Types/GraphChange.html">Graph Change</a></li></ol></li></ol></li><li class="chapter-item "><a href="DSNP/Operations.html">Operations</a></li><li class="chapter-item "><a href="DSNP/Records.html">State Change Records</a></li><li class="chapter-item "><a href="DSNP/Serializations.html">Serializations</a></li></ol></li><li class="chapter-item "><a href="Systems.html">DSNP System Specs</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Frequency/Overview.html">Frequency</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Frequency/Identity.html">Identity</a></li><li class="chapter-item "><a href="Frequency/Publishing.html">Publishing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Frequency/Validation.html">Validation</a></li></ol></li><li class="chapter-item "><a href="Frequency/Operations.html">Operations</a></li><li class="chapter-item "><a href="Frequency/Records.html">Records</a></li><li class="chapter-item "><a href="Frequency/UserData.html">User Data</a></li></ol></li></ol></li><li class="chapter-item "><a href="ActivityContent/Overview.html">Activity Content</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="ActivityContent/Types/Note.html">Note</a></li><li class="chapter-item "><a href="ActivityContent/Types/Profile.html">Profile</a></li><li class="chapter-item "><div>Associated Type</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="ActivityContent/Associated/Hash.html">Hash</a></li><li class="chapter-item "><a href="ActivityContent/Associated/Location.html">Location</a></li><li class="chapter-item "><a href="ActivityContent/Associated/Tag.html">Tag</a></li><li class="chapter-item "><a href="ActivityContent/Associated/Attachments.html">Attachments</a></li></ol></li></ol></li><li class="chapter-item "><a href="Reference/Glossary.html">Glossary</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Dark</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">DSNP Specification</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/LibertyDSNP/spec" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Type to search..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="dsnp-specification"><a class="header" href="#dsnp-specification">DSNP Specification</a></h1>
<p>Welcome to the Decentralized Social Networking Protocol (DSNP) specification.
Here you can find the detailed specification documentation for DSNP, official DSNP system specifications, and associated specifications.</p>
<h2 id="goals--purpose"><a class="header" href="#goals--purpose">Goals &amp; Purpose</a></h2>
<p>Free communication among users on the Internet faces a variety of problems in the modern day.
These challenges include censorship by state and corporate actors, the amplification of misinformation through viral content, and an ever-shrinking collection of near monopolies with absolute power over social interaction in the twenty-first century.
Through the DSNP, we hope to mitigate and ideally solve these challenges in the way social interaction operates online.</p>
<h2 id="how-to-read-this-specification"><a class="header" href="#how-to-read-this-specification">How to Read This Specification</a></h2>
<p>There are three core specifications currently.</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Version</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="DSNP/Overview.html">DSNP</a></td><td>1.2.0</td><td>The system-agnostic DSNP specification</td></tr>
<tr><td><a href="ActivityContent/Overview.html">Activity Content</a></td><td>1.2.0</td><td>A specification for DSNP-referenced content (subset of W3C Activity Streams)</td></tr>
<tr><td><a href="Frequency/Overview.html">DSNP Over Frequency</a></td><td>-</td><td>DSNP Over Frequency specification</td></tr>
</tbody></table>
</div>
<p>Each specification is divided into several modules.
Each module describes a mostly self-contained aspect of the specification.</p>
<h2 id="versioning"><a class="header" href="#versioning">Versioning</a></h2>
<p>DSNP specification versions follow <a href="https://semver.org/">Semantic Versioning 2.0</a> for releases.</p>
<h2 id="contributions"><a class="header" href="#contributions">Contributions</a></h2>
<p>Development occurs on <a href="https://github.com/LibertyDSNP/spec">GitHub</a>.
All interactions must follow the <a href="https://github.com/LibertyDSNP/spec/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a> and <a href="https://github.com/LibertyDSNP/spec/blob/main/CONTRIBUTING.md">Contribution Guidelines</a>.</p>
<h2 id="learning-more"><a class="header" href="#learning-more">Learning More</a></h2>
<p>In addition to this document, more resources regarding the project can be found at <a href="https://www.dsnp.org">DSNP.org</a>, including the blog, forum, code repository, and SDK.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dsnp-specification-1"><a class="header" href="#dsnp-specification-1">DSNP Specification</a></h1>
<p><strong>Version 1.2.0</strong></p>
<p>DSNP (Decentralized Social Networking Protocol) is a social networking protocol designed to run on a blockchain.
It specifies a set of social primitives along with requirements for interoperability.
Go to <a href="DSNP/../Systems.html">Systems</a> for specifics on how DSNP is expressed on a specific blockchain.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<h3 id="what-is-a-dsnp-system"><a class="header" href="#what-is-a-dsnp-system">What is a DSNP System?</a></h3>
<p>A DSNP system is a state machine which generates an ongoing, publicly observable and verifiable stream of state change records in response to public input.
This specification defines a set of operations (the DSNP <a href="DSNP/Operations.html">Operations</a>) that a compliant DSNP system MUST make available.
For each DSNP Operation, the DSNP specification defines the data to be provided as input, the data that will be generated as output, and the state change records (the DSNP <a href="DSNP/Records.html">State Change Records</a>) that will be observable as a result of the Operation, depending on the input and prior state of the system.</p>
<p>The nature of blockchain technology means that all DSNP Operations are potentially asynchronous; that is, DSNP State Change Records need not be created immediately upon invoking a DSNP Operation, and may appear in the stream of state changes at any subsequent time.
A DSNP Operation can therefore only be confirmed to have completed successfully by observing the stream of newly-generated DSNP Records.</p>
<p>All DSNP Records MUST be publicly visible.
On a blockchain, for example, all nodes must share a common set of Records, and a DSNP system specification MUST define how external systems can subscribe to or otherwise view all state changes.
In practical terms, this means that all users of a given DSNP system exist conceptually within a single shared social graph, and a given user MUST have the ability at a protocol level to see and participate in all public discourse.
Note, however, that this is not an application-level requirement; an application that interacts with DSNP might choose to filter what content is shown.</p>
<p>Finally, to ensure decentralization, a DSNP system MUST avoid having any single point of failure (many nodes) and MUST avoid having any single entity that can override its consensus mechanisms (many operators).</p>
<h3 id="dsnp-system-compliance"><a class="header" href="#dsnp-system-compliance">DSNP System Compliance</a></h3>
<p>Compliant DSNP system specifications MUST document how each of the required DSNP Operations (for a given version of the DSNP specification) can be invoked, including, for example, what wire protocols should be used for discovery, authentication and operation execution, and how inputs and outputs will be serialized.</p>
<p>A compliant specification MUST specify a mapping from its system-specific state change data (for example, the events emitted by a blockchain) to the DSNP State Change Records that data represents.</p>
<!--- Uncomment for pre-release changes and prefix the version with `pre-[next version]`
## Prerelease Changelog
--->
<h2 id="releases"><a class="header" href="#releases">Releases</a></h2>
<p>DSNP system specifications MUST specify the version(s) of the DSNP specification that may be used.</p>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Description</th><th>Release Date</th><th>Changelog</th></tr></thead><tbody>
<tr><td><a href="https://github.com/LibertyDSNP/spec/tree/DSNP-v1.2.0">1.2.0</a></td><td>DIP-210, DIP-216, DIP-220, DIP-225, DIP-226, DIP-227, DIP-228</td><td>2023-04-11</td><td><a href="https://github.com/LibertyDSNP/spec/releases/tag/DSNP-v1.2.0">Changelog</a></td></tr>
<tr><td><a href="https://github.com/LibertyDSNP/spec/tree/DSNP-v1.1.0">1.1.0</a></td><td>DIP-148, DIP-149, DIP-150, DIP-165, DIP-180</td><td>2022-05-06</td><td><a href="https://github.com/LibertyDSNP/spec/releases/tag/DSNP-v1.1.0">Changelog</a></td></tr>
<tr><td><a href="https://github.com/LibertyDSNP/spec/tree/DSNP-v1.0.0">1.0.0</a></td><td>Initial Release</td><td>2021-09-09</td><td><a href="https://github.com/LibertyDSNP/spec/releases/tag/DSNP-v1.0.0">Changelog</a></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="identity"><a class="header" href="#identity">Identity</a></h1>
<p>This specification is intended to cover the concept of identity and how identity is represented within the protocol.</p>
<h2 id="identifiers"><a class="header" href="#identifiers">Identifiers</a></h2>
<p>DSNP <a href="DSNP/Identifiers.html">Identifiers</a> form the basis for pseudo-anonymous streams of content.
While some users may choose to link or expose their real-world identity, DSNP implementations MUST NOT require such data exposure for account creation.
The <a href="DSNP/Graph.html">social graph</a> is formed using this Identifier so that a user's connections maintain integrity regardless of changes in any user's client choices or access changes.</p>
<h3 id="pseudo-anonymity"><a class="header" href="#pseudo-anonymity">Pseudo Anonymity</a></h3>
<ul>
<li>An Identifier MUST default to being disconnected from a real-world identity.</li>
<li>An Identifier MUST be unique to the implementation.</li>
</ul>
<h2 id="ownership"><a class="header" href="#ownership">Ownership</a></h2>
<p>A user's ownership of their identity is expressed via ownership and control of their pseudo-anonymous Identifier(s).
Control entails the power to invoke DSNP Operations including publishing <a href="DSNP/Announcements.html">Announcements</a> that create, update and delete (Tombstone) content associated with the Identifier, <a href="DSNP/Identity.html#delegation">delegating</a> these powers to others, <a href="DSNP/Identity.html#key-management">managing keys</a> associated with the Identifier, and <a href="DSNP/Identity.html#retirement">retiring</a> the Identifier.</p>
<h3 id="key-management"><a class="header" href="#key-management">Key Management</a></h3>
<p>An initial control key must be created in order to acquire an Identifier.
Each distinct Identifier MUST have distinct control keys; that is, the same key MUST NOT be linked to multiple Identifiers.
Optionally, an implementation MAY allow the user to add and remove additional keys.
An implementation MUST NOT allow the user to remove the only or last remaining control key.</p>
<h3 id="retirement"><a class="header" href="#retirement">Retirement</a></h3>
<p>A user may choose to retire their Identifier at any time.
Once an Identifier is retired, an implementation MAY remove all state data associated with that Identifier, provided that an indication that the Identifier is retired remains, so it may not be reused in the future.
This means that all data previously sent from the Identifier, the keys associated with the Identifier, and the delegations (see next section) associated with the Identifier may be removed.</p>
<p>After an Identifier is retired, any existing or future <a href="DSNP/Announcements.html">Announcements</a> from the Identifier should be treated as if they have been <a href="DSNP/Types/Tombstone.html">tombstoned</a> (for Announcement Types that support tombstoning).
A retired Identifier MUST NOT be allowed to act as a principal for any additional DSNP <a href="DSNP/Operations.html">Operations</a>.</p>
<h3 id="delegation"><a class="header" href="#delegation">Delegation</a></h3>
<ul>
<li>An owner MUST be able to delegate permission to announce on their behalf to other parties.</li>
<li>A user MUST be able to revoke delegated permissions.</li>
<li>Announcements from a delegate MUST be able to be verify which delegate made the specific Announcement.</li>
<li>Delegation revocation MUST NOT be retroactive.</li>
</ul>
<h2 id="related-operations"><a class="header" href="#related-operations">Related Operations</a></h2>
<ul>
<li><a href="DSNP/Operations.html#create-identifier">Create Identifier</a></li>
<li><a href="DSNP/Operations.html#retire-identifier">Retire Identifier</a></li>
<li><a href="DSNP/Operations.html#define-delegation">Define Delegation</a></li>
<li><a href="DSNP/Operations.html#revoke-delegation">Revoke Delegation</a></li>
<li><a href="DSNP/Operations.html#add-control-key">Add Control Key</a></li>
<li><a href="DSNP/Operations.html#remove-control-key">Remove Control Key</a></li>
</ul>
<h2 id="non-normative"><a class="header" href="#non-normative">Non-normative</a></h2>
<h3 id="retroactive-revocation-of-delegation"><a class="header" href="#retroactive-revocation-of-delegation">Retroactive Revocation of Delegation</a></h3>
<p>There are times when one might desire retroactive revocation of delegation, if for example, a key were found to have been compromised at an earlier time.
However, retroactive revocation is much more difficult from a caching and performance perspective.
Instead <a href="DSNP/Announcements.html#reverting-an-announcement">reverting any undesirable Announcements</a> via <a href="DSNP/Types/Tombstone.html">Tombstones</a> allows a user to choose which specific events need reverting and then notify the network of that change.</p>
<p>To this end, any <a href="DSNP/BatchPublications.html">Batch Publications</a> can always be validated from the perspective of the time they were published, and do not require re-validation at future read times.
The validity of a Batch is thus immutable.</p>
<ol>
<li>Collect all the DSNP Ids used in a Batch.</li>
<li>Validate that each DSNP Id had delegated to the publisher of the Batch at the time of publishing.</li>
<li>Validate that any failures from step 2 were from DSNP Ids that revoked delegation within the acceptance window of prior blocks.</li>
<li>Record the batch as valid or invalid.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="identifiers-1"><a class="header" href="#identifiers-1">Identifiers</a></h1>
<p>The DSNP Identifiers form the basis for pseudo-anonymous streams of content.
Graph connections are formed through the DSNP User Id.</p>
<h2 id="dsnp-user-id"><a class="header" href="#dsnp-user-id">DSNP User Id</a></h2>
<ul>
<li>64-bit Unsigned Integer</li>
<li>MUST be serialized as <a href="DSNP/Serializations.html#decimal">decimal</a></li>
<li>MUST be unique per implementation</li>
</ul>
<h2 id="dsnp-content-hash"><a class="header" href="#dsnp-content-hash">DSNP Content Hash</a></h2>
<ul>
<li>Variable length byte array (fixed length for a given hashing algorithm)</li>
<li>MUST be a valid <a href="https://github.com/multiformats/multihash">multihash</a> encoding of the hash output for the bytes of the content, generated with a <a href="DSNP/Announcements.html#supported-hashing-algorithms">Supported Hashing Algorithm</a></li>
</ul>
<h3 id="supported-hashing-algorithms"><a class="header" href="#supported-hashing-algorithms">Supported Hashing Algorithms</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Algorithm</th><th>Multihash Name</th><th>Leading bytes (as <a href="https://github.com/multiformats/unsigned-varint">varint</a>)</th><th>Reference</th><th>DSNP Version Added</th></tr></thead><tbody>
<tr><td>SHA-256</td><td><code>sha2-256</code></td><td><code>0x1220</code></td><td><a href="https://tools.ietf.org/html/rfc6234">RFC 6234</a></td><td>1.2.0</td></tr>
<tr><td>BLAKE2b</td><td><code>blake2b-256</code></td><td><code>0xa0e40220</code></td><td><a href="https://tools.ietf.org/html/rfc7693">RFC 7693</a></td><td>1.2.0</td></tr>
</tbody></table>
</div>
<h2 id="dsnp-protocol-scheme"><a class="header" href="#dsnp-protocol-scheme">DSNP Protocol Scheme</a></h2>
<ul>
<li>MUST always be the string <code>dsnp://</code></li>
</ul>
<h2 id="dsnp-user-uri"><a class="header" href="#dsnp-user-uri">DSNP User URI</a></h2>
<p>The DSNP User URI consists of two parts: the scheme and the user id.
It is used to identify a user via a URI.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<pre><code>dsnp://1311768467294899700
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>part</th><th>value</th></tr></thead><tbody>
<tr><td>Scheme</td><td><code>dsnp://</code></td></tr>
<tr><td>User Id</td><td><code>1311768467294899700</code></td></tr>
</tbody></table>
</div>
<h2 id="dsnp-content-uri"><a class="header" href="#dsnp-content-uri">DSNP Content URI</a></h2>
<p>The DSNP Content URI consists of three parts: the scheme, the user id, and the content hash.
It is used to uniquely identify an Announcement from a given user with content.</p>
<p>Any <a href="DSNP/Announcements.html#announcement-types">Announcement Types</a> with a <code>fromId</code> and <code>contentHash</code> have a DSNP Content URI.</p>
<h3 id="example-1"><a class="header" href="#example-1">Example</a></h3>
<pre><code>dsnp://78187493520/0x1234567890abcdef0123456789abcdef0123456789abcdef0123456789abcdef
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>part</th><th>value</th></tr></thead><tbody>
<tr><td>Scheme</td><td><code>dsnp://</code></td></tr>
<tr><td>User Id</td><td><code>78187493520</code></td></tr>
<tr><td>Content Hash</td><td><code>0x1234567890abcdef0123456789abcdef0123456789abcdef0123456789abcdef</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="graph"><a class="header" href="#graph">Graph</a></h1>
<p>This specification describes the social network graph and how it is represented in the protocol.</p>
<p>In this context a <a href="https://en.wikipedia.org/wiki/Social_graph">social graph</a> means a graph that represents social relationships between entities.</p>
<h2 id="nodes"><a class="header" href="#nodes">Nodes</a></h2>
<p>Users are represented in the DSNP graph by nodes uniquely identified by their <a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Ids</a>.
Relationships between users are the graph edges.</p>
<h2 id="edges"><a class="header" href="#edges">Edges</a></h2>
<p>Graph edges that originate from a user are stored as DSNP <a href="DSNP/UserData.html">User Data</a> associated with a given user.
DSNP user data structures capture three distinct sets of relationships, as described below.</p>
<h3 id="public-follows"><a class="header" href="#public-follows">Public Follows</a></h3>
<p>Each <a href="DSNP/UserData.html#public-follows">public follow</a> records a unidirectional relationship where one user (the controller of the graph) is interested in following the public speech of another user.
When follows are public, they are visible to any other user or system, including the user being followed.</p>
<h3 id="private-follows"><a class="header" href="#private-follows">Private Follows</a></h3>
<p>A <a href="DSNP/UserData.html#private-follows">private follow</a>  records an interest in following the public speech of another user, but the data is stored in encrypted form.
The relationship is not visible to the followed user or any other user that does not have the decryption key.</p>
<h3 id="private-connections"><a class="header" href="#private-connections">Private Connections</a></h3>
<p><a href="DSNP/UserData.html#private-connections">Private connections</a> represent one half of a bidirectional relationship between two DSNP Users.
Private connections are stored on both sides of the bidirectional relationship between two DSNP Users.
Each user can then update the status of the relationship without loss of privacy.
Each DSNP user maintains and controls two sets of data:</p>
<ol>
<li>An encrypted data set that records which users are recognized as connections.</li>
<li>A public data set that is used to signal connection status via Pseudonymous Relationship Identifiers.</li>
</ol>
<h3 id="pseudonymous-relationship-identifiers"><a class="header" href="#pseudonymous-relationship-identifiers">Pseudonymous Relationship Identifiers</a></h3>
<p>Private connections are complemented by publishing <a href="DSNP/UserData.html#private-connection-prids">private connection Pseudonymous Relationship Identifiers</a> (PRIds), which provide a means of making the connection relationship visible to the other user while maintaining privacy with respect to any third parties.
Applications are encouraged to verify connection relationships by checking to see that they are reciprocated, with the appropriate identifier present in both users' data.</p>
<p>For each pair of users Alice and Bob, and a specified PRId <a href="DSNP/Graph.html#contexts">context</a>, a pair of PRIds can be generated from Alice and Bob's shared secret, with one representing a simplex channel from Alice to Bob, and the other representing the corresponding simplex channel from Bob to Alice.</p>
<p>PRIds have the following properties:</p>
<ul>
<li>If Alice has generated a PRId from Alice to Bob, only Bob can generate the same PRId. This allows Bob to check if he is listed in Alice's published connections.</li>
<li>Bob can prove to a third party that a given PRId in Alice's published connections is his, without allowing the third party to discover Alice or Bob's relationships with any other user.</li>
</ul>
<p>A detailed discussion of the cryptography for PRIds can be found in the <a href="DSNP/Types/PRId.html">PRId object definition</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-data"><a class="header" href="#user-data">User Data</a></h1>
<p>DSNP stores user-related data of well defined formats associated with a user's DSNP Identifier.
DSNP User Data is designed for data with the following characteristics:</p>
<ul>
<li>The data is intended to be accessible across the network with the strongest possible durability guarantees</li>
<li>The data may change frequently.</li>
<li>The data does not need to be widely announced and instead can be read just-in-time for a particular user.</li>
</ul>
<p>Data may be public or stored in encrypted form.
The <a href="https://avro.apache.org">Avro</a> schema specification is used to define the binary representation of relevant data types.</p>
<h2 id="user-data-types"><a class="header" href="#user-data-types">User Data Types</a></h2>
<p>DSNP implementations MUST support the following User Data Types:</p>
<div class="table-wrapper"><table><thead><tr><th>System Name</th><th>Version</th><th>Encryption Algorithm</th><th>Compression Codec</th><th>Avro Object Type</th></tr></thead><tbody>
<tr><td><a name="public-follows"><code>publicFollows</code></a></td><td>1.2</td><td>NONE</td><td><a href="https://en.wikipedia.org/wiki/Deflate"><code>DEFLATE</code></a></td><td><a href="DSNP/Types/GraphEdge.html">GraphEdge</a></td></tr>
<tr><td><a name="private-follows"><code>privateFollows</code></a></td><td>1.2</td><td><code>curve25519xsalsa20poly1305</code></td><td><a href="https://en.wikipedia.org/wiki/Deflate"><code>DEFLATE</code></a></td><td><a href="DSNP/Types/GraphEdge.html">GraphEdge</a></td></tr>
<tr><td><a name="private-connections"><code>privateConnections</code></a></td><td>1.2</td><td><code>curve25519xsalsa20poly1305</code></td><td><a href="https://en.wikipedia.org/wiki/Deflate"><code>DEFLATE</code></a></td><td><a href="DSNP/Types/GraphEdge.html">GraphEdge</a></td></tr>
<tr><td><a name="private-connection-prids"><code>privateConnectionPRIds</code></a></td><td>1.2</td><td>NONE</td><td>NONE</td><td><a href="DSNP/Types/PRId.html">PRId</a></td></tr>
</tbody></table>
</div>
<p>Data for each data type is initially formatted as a stream of Avro objects that should conform to the schema specified.
Avro file- and block-level information (including in-stream schema) is omitted.
The Avro stream is then compressed and/or encrypted as specified.</p>
<p><code>curve25519xsalsa20poly1305</code> (that is, X25519 key exchange, XSalsa20 encryption, and Poly1305 message authentication) is the default authenticated encryption algorithm used in the <a href="https://nacl.cr.yp.to">NaCl</a> (&quot;Salt&quot;) library, and its successor <a href="https://libsodium.org">libsodium</a>.
In the specification of cryptographic operations below, relevant methods from these libraries are noted. While these specific libraries are not required for DSNP compatibility, they are highly recommended.</p>
<h2 id="data-chunks"><a class="header" href="#data-chunks">Data Chunks</a></h2>
<p>Because blockchain systems often have specific limits to the amount of data that can be included in a given transaction, operations on user data deal with the data in discrete chunks.
As implementation strategies may vary, implementations MUST define their own maximum chunk size in bytes to be used in the operations described below.</p>
<h2 id="entity-tags"><a class="header" href="#entity-tags">Entity Tags</a></h2>
<p>To allow for application-layer caching and prevent race conditions between different applications attempting to update the same data, an implementation MUST provide a non-empty <code>etag</code> (entity tag) value with each chunk fetched, and update this for each chunk replaced.</p>
<p>An <code>etag</code> is any ASCII-encoded string with a minimum length of one byte and a maximum length of 255 bytes.</p>
<p>An implementation MUST fail the Replace User Data Operation if the <code>etag</code> values supplied do not match the current <code>etag</code> values for all chunks of the specified data type.</p>
<h2 id="replace-user-data-operation"><a class="header" href="#replace-user-data-operation">Replace User Data Operation</a></h2>
<p>The Replace User Data Operation takes the following parameters:</p>
<ul>
<li>A DSNP User Id
<ul>
<li>Implementations MUST ensure that the principal invoking this Operation is this user, or a transparent chain of delegation from the user to the principal exists.</li>
</ul>
</li>
<li>A <a href="DSNP/Types/PublicKey.html#keyid">Key Identifier</a> for the <code>keyAgreement</code> key pair used to encrypt any private data in the operation.
(If only unencrypted user data types are included, the key identifier is optional.)</li>
<li>A map containing the set of data types to update as the keys, and tuples consisting of (1) the schema version used to encode the data type, and (2) a list where each element includes a data chunk and its associated entity tag, as the values.</li>
</ul>
<p>If the Operation is successful, any previous data associated with the user for each data type included in the input MUST be removed and replaced by the new data.</p>
<p>Data chunks should be generated for each included data type using the following sequence of operations:</p>
<ol>
<li>Serialize the data records, in Avro binary format, according to the versioned schema.</li>
<li>Divide the data records into one or more chunks, with each chunk containing a maximum byte count specified by the implementation.</li>
</ol>
<ul>
<li>Note that the combined chunks constitute a different, and smaller, binary than a complete Avro file, as they exclude the header information, schema, and any block-level metadata.
Each chunk should start and end with a complete Avro object; in other words, chunk boundaries MUST NOT occur mid-record.
Applications SHOULD try to include as many records as possible within the byte length limit, but because compression and encryption may alter the byte size versus the raw Avro binary records, they may wish to use a heuristic approach that sometimes produces non-optimal chunks.</li>
</ul>
<ol start="3">
<li>For each chunk generated, the application should then:
<ol>
<li>If the data type requires compression, apply the compression codec noted.</li>
<li>If the data type requires encryption,
<ol>
<li>Retrieve the user's active (most recently announced) <code>keyAgreement</code> public key, U<sub>public</sub>.
The <code>keyId</code> in the announcement should match the key identifier provided for this Operation.
If no key exists, one should be created and published as an Announcement before invoking the Operation.</li>
<li>Create a sealed box (a payload encrypted with a symmetric key derived from an ephemeral key pair, and accompanied by the ephemeral public key), as in the <a href="https://doc.libsodium.org/public-key_cryptography/sealed_boxes">libsodium</a> function <code>crypto_box_seal</code>, using U<sub>public</sub>.</li>
<li>Include the previous <code>etag</code> value for the chunk. If the chunk is new, <code>etag</code> should be set to <code>null</code>.
If any chunks are to be deleted, they should be included in the input identified with the existing <code>etag</code> and a <code>null</code> value for the data.</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>If the Operation is invoked successfully the implementation MUST synchronously return a new set of <code>etag</code> values for each data type replaced, corresponding to the updated state of the data (with new chunks added and deleted chunks removed).
Applications should not interpret this response as an indication that the operation was completed and a state change record emitted, as this typically occurs asynchronously.
However, this strategy allows applications to make the optimistic assumption that, in due course, the DSNP system will reflect the intended changes, without needing to wait for asynchronous confirmation.</p>
<p>If, on the other hand, an invocation of Replace User Data is rejected due to entity tag discrepancies, this indicates that the relevant data on the network has changed since the entity tags were acquired by the application, and the application should fetch the most current version with the <a href="DSNP/UserData.html#get-user-data-operation">Get User Data Operation</a>, reapply any intended changes, and retry the operation.</p>
<p>The Replace User Data Operation MUST generate a <a href="DSNP/Records.html#user-data-replaced">User Data Replaced Record</a> containing the DSNP User Id and the set of updated User Data Types (but not the data itself).
If the implementation detects that no change has occurred, it SHOULD omit the relevant unchanged data types from the state change record.</p>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<p><em>The following section is non-normative.</em>
<em>The JSON schema and encoding used is provided for illustration only and implementations are free to define their own encoding.</em></p>
<p>The following example illustrates the input to the Replace User Data Operation corresponding to the following scenario (utilizing <a href="DSNP/Graph.html">social graph</a> data types):</p>
<ul>
<li>The user's previously stored data consists of one chunk for public follows, two chunks for private connections, and one chunk for private connection declarations.</li>
<li>The user adds several follows to their public list, causing it to exceed the maximum capacity for a single chunk and require a new chunk.</li>
<li>The user adds a relationship to their private connections, but it still fits in two chunks.
The private connection's PRId is added to the private connection PRId list, but it remains a single chunk.</li>
</ul>
<pre><code>{
  &quot;publicFollows&quot;: {
    &quot;version&quot;: &quot;1.2&quot;,
    &quot;chunks&quot;: [
      {
        &quot;etag&quot;: string                             // unchanged chunk
      },
      {
        &quot;data&quot;: base64(compress(chunk2)),
        &quot;etag&quot;: null,                              // new chunk
      }
    ]
  },
  &quot;privateFollows&quot;: {
    &quot;version&quot;: &quot;1.2&quot;,
    &quot;chunks&quot;: [
      {
        &quot;etag&quot;: string                             // unchanged chunk
      },
      {
        &quot;data&quot;: base64(encrypt(compress(chunk2))), // updated chunk
        &quot;etag&quot;: string
      }
    ]
  },
  &quot;privateConnectionPRIds&quot;: {
    &quot;version&quot;: &quot;1.2&quot;,
    &quot;chunks&quot;: [
      {
        &quot;data&quot;: base64(compress(chunk1)),
        &quot;etag&quot;: string
      }
    ]
  }
}
</code></pre>
<p>Deletion of records may cause situations where the number of chunks decreases.
To ensure that the deleted chunk was up to date, the deleted chunk should still be included in the array with the relevant entity tag value, using an explicit <code>null</code> value for the data field to indicate deletion, as in the following snippet:</p>
<pre><code>  &quot;publicFollows&quot;: {
    &quot;version&quot;: &quot;1.2&quot;,
    &quot;chunks&quot;: [
      {
        &quot;etag&quot;: string                     // unchanged chunk
      },
      {
        &quot;data&quot;: null,                      // deleted chunk
        &quot;etag&quot;: string,
      }
    ]
  }
</code></pre>
<h2 id="get-user-data-operation"><a class="header" href="#get-user-data-operation">Get User Data Operation</a></h2>
<p>The Get User Data Operation takes the following parameters:</p>
<ul>
<li>The DSNP User Id of the user who controls the data
<ul>
<li>Note: While <em>writing</em> user data is reserved for the user and any delegates, anyone on the network can read any user's data (though it may be encrypted).</li>
</ul>
</li>
<li>The User Data Types (by system name) that should be retrieved.</li>
</ul>
<p>The operation returns a mapping of User Data Type to data chunks, with each data chunk annotated with an entity tag and (optionally) a key identifier. (Note that this is the same general structure as the input data for <a href="DSNP/UserData.html#replace-user-data-operation">Replace User Data</a>, for each requested data type.
If no chunks for a requested data type exist, an implementation MAY omit that data type from the response.</p>
<p>To transform the data from the output to Avro binary records, a consumer should apply the following algorithm to each data type included:</p>
<ol>
<li>Determine the relevant encryption algorithm, compression codec, and object schema from the User Data Type and version noted.</li>
<li>For each chunk,
<ol>
<li>If encryption is indicated, decrypt the chunk data using the user's secret key (identified using the key identifier) as in the <a href="https://doc.libsodium.org/public-key_cryptography/sealed_boxes">libsodium</a> function <code>crypto_box_seal_open</code>.</li>
<li>If compression is required, uncompress the chunk data using the specified codec.</li>
<li>Deserialize the uncompressed data to logical records according to the Avro object schema.</li>
<li>Retain the chunk's <code>etag</code> value if needed for any updates.</li>
</ol>
</li>
</ol>
<h3 id="examples-1"><a class="header" href="#examples-1">Examples</a></h3>
<p><em>The following section is non-normative.</em>
<em>The JSON schema and encoding used is provided for illustration only and implementations are free to define their own encoding.</em></p>
<p>The following example illustrates the output of a Get User Data Operation invocation requesting data for <code>publicFollows</code>, <code>privateConnections</code>, and <code>privateConnectionPRIds</code>:</p>
<pre><code>{
  &quot;publicFollows&quot;: {
    &quot;version&quot;: &quot;1.2&quot;,
    &quot;chunks&quot;: [
      {
        &quot;data&quot;: base64_string,
        &quot;etag&quot;: string
      },
      {
        &quot;data&quot;: base64_string,
        &quot;etag&quot;: string
      }
    ]
  },
  &quot;privateConnections&quot;: {
    &quot;version&quot;: &quot;1.2&quot;,
    &quot;chunks&quot;: [
      {
        &quot;data&quot;: base64_string,
        &quot;etag&quot;: string,
        &quot;keyId&quot;: integer
      },
      {
        &quot;data&quot;: base64_string,
        &quot;etag&quot;: string,
        &quot;keyId&quot;: integer
      }
    ]
  },
  &quot;privateConnectionPRIds&quot;: {
    &quot;version&quot;: &quot;1.2&quot;,
    &quot;chunks&quot;: [
      {
        &quot;data&quot;: base64_string,
        &quot;etag&quot;: string
      }
    ]
  }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graph-edge"><a class="header" href="#graph-edge">Graph Edge</a></h1>
<p>Relationships between users are represented using the GraphEdge object.</p>
<h2 id="serialization"><a class="header" href="#serialization">Serialization</a></h2>
<p>GraphEdge object serialization MUST conform to the following <a href="https://avro.apache.org">Avro</a> schema:</p>
<pre><code>{
    &quot;namespace&quot;: &quot;org.dsnp&quot;,
    &quot;name&quot;: &quot;GraphEdge&quot;,
    &quot;type&quot;: &quot;record&quot;,
    &quot;doc&quot;: &quot;A relationship to another DSNP user&quot;,
    &quot;fields&quot;: [
        {
            &quot;name&quot;: &quot;userId&quot;,
            &quot;type&quot;: &quot;long&quot;,
            &quot;doc&quot;: &quot;The other user's DSNP User Id&quot;
        },
        {
            &quot;name&quot;: &quot;since&quot;,
            &quot;type&quot;: &quot;long&quot;,
            &quot;doc&quot;: &quot;Timestamp in Unix epoch seconds when this relationship was originally established&quot;
        }
    ]
}
</code></pre>
<h2 id="generation"><a class="header" href="#generation">Generation</a></h2>
<h3 id="userid"><a class="header" href="#userid">userId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
</ul>
<p><mark>To allow for optimal compression, User Ids are stored using the <tt>long</tt> type in Avro schema, which is a 64-bit <em>signed</em> integer.
Care should be taken to ensure that User Id values greater than or equal to 2<sup>63</sup>, where used by an implementation, are converted correctly between signed and unsigned representations.</mark></p>
<h3 id="since"><a class="header" href="#since">since</a></h3>
<ul>
<li>MUST be a value in seconds since the <a href="https://en.wikipedia.org/wiki/Unix_time">Unix epoch</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prid"><a class="header" href="#prid">PRId</a></h1>
<p>A Pseudonymous Relationship Identifier is represented by the PRId object type.</p>
<h2 id="serialization-1"><a class="header" href="#serialization-1">Serialization</a></h2>
<p>PRId object serialization MUST conform to the following <a href="https://avro.apache.org">Avro</a> schema:</p>
<pre><code>{
    &quot;namespace&quot;: &quot;org.dsnp&quot;,
    &quot;name&quot;: &quot;PRId&quot;,
    &quot;type&quot;: &quot;fixed&quot;,
    &quot;size&quot;: 8,
    &quot;doc&quot;: &quot;Pseudonymous Relationship Identifier&quot;
}
</code></pre>
<h2 id="generation-1"><a class="header" href="#generation-1">Generation</a></h2>
<p>PRIds are generated cryptographically to represent a relationship from one user to another within a specified context, in a privacy-preserving manner.</p>
<h3 id="contexts"><a class="header" href="#contexts">Contexts</a></h3>
<p>The following context values are currently defined for PRIds. All other values are reserved for future use.</p>
<div class="table-wrapper"><table><thead><tr><th>Context Id</th><th>Description</th><th>Context string</th></tr></thead><tbody>
<tr><td>0</td><td>Connection</td><td><code>PRIdCtx0</code></td></tr>
</tbody></table>
</div>
<h3 id="algorithm"><a class="header" href="#algorithm">Algorithm</a></h3>
<p>In the following section, the Alice to Bob identifier for context C is called PRId<sub>A→B,C</sub>, and the corresponding Bob to Alice identifier is called PRId<sub>B→A,C</sub>.</p>
<p>A PRId is derived from Alice and Bob's <code>keyAgreement</code> key pairs, using a key exchange protocol as follows. To illustrate the cryptographic operations required, the relevant functions from <a href="https://libsodium.org">libsodium</a> are noted. Sodium is a stable, fast, free, and cross-platform cryptography library, and supports all encryption algorithms used in the DSNP specification out of the box.</p>
<p>Definitions:</p>
<ul>
<li><code>Id<sub>A</sub> = <em>DSNP User Id of A (little-endian)</em></code></li>
<li><code>Id<sub>B</sub> = <em>DSNP User Id of B (little-endian)</em></code></li>
</ul>
<p>Algorithm:</p>
<ol>
<li>Both Alice and Bob generate an asymmetric key pair for use with X25519 <abbr title="Elliptic Curve Integrated Encryption Scheme">ECIES</abbr>.
Each publishes a Public Key Announcement with their generated public key with a <code>keyType</code> value of <code>keyAgreement</code>.</li>
</ol>
<table style="table-layout:fixed">
<tr><th>Libsodium</th><th>Algorithm</th></tr>
<tr><td>
<tt>
<pre>
<a href="https://libsodium.gitbook.io/doc/public-key_cryptography/authenticated_encryption#key-pair-generation">crypto_box_keypair</a>(
  &a_public,
  &a_secret);
<a href="https://libsodium.gitbook.io/doc/public-key_cryptography/authenticated_encryption#key-pair-generation">crypto_box_keypair</a>(
  &b_public, 
  &b_secret);
  </pre>
</tt>
</td><td>
<tt><pre>
(A<sub>public</sub>, A<sub>secret</sub>) &#8592; <abbr title="Key Generation Function">KGF</abbr>()
(B<sub>public</sub>, B<sub>secret</sub>) &#8592; <abbr title="Key Generation Function">KGF</abbr>()
</tt></pre>
</td></tr></table>
<ol start="2">
<li>When Alice wants to interact with Bob, she looks up Bob's public key and performs an X25519 Elliptic-curve Diffie-Hellman key exchange operation using her secret key and Bob's public key, generating a root shared secret.</li>
</ol>
<table style="table-layout:fixed">
<tr><th>Libsodium</th><th>Algorithm</th></tr>
<tr><td>
<tt><pre>
<a href="https://libsodium.gitbook.io/doc/public-key_cryptography/authenticated_encryption#precalculation-interface">crypto_box_beforenm</a>(
  &root_shared_secret,
  b_public,
  a_secret);
</pre></tt>
</td><td>
<tt><pre>
RootSharedSecret<sub>AB</sub> &#8592;
  <abbr title="Elliptic-curve Diffie-Hellman">ECDH</abbr>(B<sub>public</sub>, A<sub>secret</sub>)
</pre></tt>
</td></tr></table>
<ol start="3">
<li>Alice derives a context-specific subkey <code>CtxSharedSecret<sub>Bob</sub></code> from the shared secret <code>RootSharedSecret</code> as the master key, Bob's DSNP User Id as the 64-bit key identifier, and the ASCII encoding of the <a href="DSNP/Types/PRId.html#contexts">PRId Context</a> string (<code>&quot;PRIdCtx0&quot;</code> for connections).</li>
</ol>
<table style="table-layout:fixed">
<tr><th>Libsodium</th><th>Algorithm</th></tr>
<tr><td>
<tt><pre>
<a href="https://libsodium.gitbook.io/doc/key_derivation">crypto_kdf_derive_from_key</a>(
  ctx_shared_secret,
  32,
  b_user_id,
  "PRIdCtx0",
  root_shared_secret);
</pre></tt>
</td><td>
<tt><pre>
CtxSharedSecret<sub>A→B</sub> &#8592
  Blake2b<sub>256</sub>(
    key = RootSharedSecret<sub>AB</sub>,
    message = {},
    salt = Id<sub>B</sub> || {0},
    personal = "PRIdCtx0" || {0})
</pre></tt>
</td></tr></table>
<ol start="4">
<li>Alice uses Bob's DSNP User Id to form an 8-byte little-endian message.
Alice encrypts this message using <a href="http://cr.yp.to/snuffle/xsalsa-20110204.pdf">XSalsa20</a> with the PRId key <code>CtxSharedSecret<sub>A→B</sub></code> and a nonce of her own User Id (little-endian) followed by 16 zero bytes.</li>
</ol>
<table style="table-layout:fixed">
<tr><th>Libsodium</th><th>Algorithm</th></tr>
<tr><td>
<tt><pre>
char nonce[24] = {0};
int i;
for (i = 0; i < 8; i++) {
  nonce[i] = (user_id_a >> (i*8))
    & 0xff;
}<br>
<a href="https://libsodium.gitbook.io/doc/secret-key_cryptography/secretbox#detached-mode">crypto_secretbox_detached</a>(
  &prid,
  &mac_unused,
  user_id_b,
  8,
  nonce,
  ctx_shared_secret);
</pre></tt>
<ul>
<li><i>Alice's act of publishing provides authentication, so the <abbr title="Message Authentication Code">MAC</abbr> is unused.</i></li>
</ul>
</td><td>
<tt><pre>
PRId<sub>A→B,C</sub> &#8592
  XSalsa20(
    message = Id<sub>B</sub>,
    key = CtxSharedSecret<sub>A→B</sub>,
    nonce = Padded24BytesLE(Id<sub>A</sub>)
  )
</pre></tt>
</td></tr></table>
<ol start="6">
<li>Alice adds the generated PRId to the relevant list of PRIds and publishes an updated copy via the <a href="DSNP/Types/../UserData.html#replace-user-data-operation">Replace User Data</a> Operation.</li>
</ol>
<p>Similarly, Bob can calculate the same root shared secret <code>RootSharedSecret</code> using <code>Alice<sub>public</sub></code> and <code>Bob<sub>secret</sub></code> and derive the same <code>PRId<sub>A→B,C</sub></code> in order to check if it is in Alice's published PRIds.
Bob can also derive the PRId subkey for Alice's DSNP User Id and encrypt Alice's User Id, using his own as the nonce, to generate the Bob-to-Alice PRId (<code>PRId<sub>B→A,C</sub></code>), and then publish it to his own list, if desired.</p>
<p>If Alice or Bob wants to prove to a third party that their PRIds are in each other's PRId list, they can provide the third party with their own subkey <code>CtxSharedSecret<sub>A→B</sub></code> or <code>CtxSharedSecret<sub>B→A</sub></code>.
The third party can repeat the encryption step using Alice and Bob's User Ids, and check that the output is present in the published set of PRIds. The root shared secret <code>RootSharedSecret</code> (used as a master key in this algorithm) should <em>not</em> be divulged.</p>
<h3 id="test-vector"><a class="header" href="#test-vector">Test Vector</a></h3>
<p>For the following inputs:</p>
<div class="table-wrapper"><table><thead><tr><th>Input</th><th>Value</th></tr></thead><tbody>
<tr><td><tt>A<sub>secret</tt></td><td><code>0xc9432ed5c0c5c24e8a4ff190619893918b4d1265a67d123895023fa7324b43e0</code></td></tr>
<tr><td><tt>A<sub>public</sub></tt></td><td><code>0x0fea2cafabdc83752be36fa5349640da2c828add0a290df13cd2d8173eb2496f</code></td></tr>
<tr><td><tt>B<sub>secret</sub></tt></td><td><code>0xdc106e1371293ee9536956e1253f43f8941d4a5c4e40f15968d24b75512b6920</code></td></tr>
<tr><td><tt>B<sub>public</sub></tt></td><td><code>0xd0d4eb21db1df63369c147e63b2573816dd4b3fe513e95bf87f7ed1835407e62</code></td></tr>
<tr><td><tt>Id<sub>A</sub></tt></td><td><code>42</code></td></tr>
<tr><td><tt>Id<sub>B</sub></tt></td><td><code>478</code></td></tr>
<tr><td><tt>Context</tt></td><td><code>PRIdCtx0</code></td></tr>
</tbody></table>
</div>
<p>An implementation of the PRId generation algorithm should produce the following outputs:</p>
<div class="table-wrapper"><table><thead><tr><th>Output</th><th>Value</th></tr></thead><tbody>
<tr><td><tt>PRId<sub>A→B</sub></tt></td><td><code>0xace4d2995b1a829c</code></td></tr>
<tr><td><tt>CtxSharedSecret<sub>A→B</sub></tt></td><td><code>0x37cb1a870f0c1dce06f5116faf145ac2cf7a2f7d30136be4eea70c324932e6d2</code></td></tr>
<tr><td><tt>PRId<sub>B→A</sub></tt></td><td><code>0x1a53b02a26503600</code></td></tr>
<tr><td><tt>CtxSharedSecret<sub>B→A</sub></tt></td><td><code>0x32c45c49fcfe12f9db60e74fa66416c5a05832c298814d82032a6783a4b1fca0</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="batch-publications"><a class="header" href="#batch-publications">Batch Publications</a></h1>
<p>A Batch Publication is an <a href="https://github.com/apache/parquet-format">Apache Parquet</a> file with a collection of <a href="DSNP/Announcements.html">Announcements</a>.</p>
<h2 id="implementation-requirements"><a class="header" href="#implementation-requirements">Implementation Requirements</a></h2>
<h3 id="discoverable"><a class="header" href="#discoverable">Discoverable</a></h3>
<p>Implementations MUST have publicly discoverable Batch Publications.</p>
<h3 id="validity"><a class="header" href="#validity">Validity</a></h3>
<p>Implementations MUST be able to validate Parquet file contents.
Validity MUST be immutable.</p>
<h3 id="historical"><a class="header" href="#historical">Historical</a></h3>
<p>Implementations MUST retain proof of existence of a Batch Publication.</p>
<h3 id="transparent-chain-of-delegation"><a class="header" href="#transparent-chain-of-delegation">Transparent Chain of Delegation</a></h3>
<p>All Announcements in a Batch file MUST be able to be proven to be from or have a chain of delegation to the publisher of the Batch.</p>
<h2 id="file-requirements"><a class="header" href="#file-requirements">File Requirements</a></h2>
<p>Batch files are stored and transferred in Apache Parquet format.</p>
<ul>
<li>Batch files MUST match the spec for a single <a href="DSNP/Announcements.html">Announcement Type</a>.</li>
<li>Batch files MUST have Bloom filters set in accordance with the Announcement Type Spec.</li>
<li>Batch files MUST have NO MORE THAN 128*1024 rows.</li>
</ul>
<h3 id="bloom-filter"><a class="header" href="#bloom-filter">Bloom Filter</a></h3>
<ul>
<li>A Bloom filter MUST be a <a href="https://github.com/apache/parquet-format/blob/apache-parquet-format-2.9.0/BloomFilter.md">Split Block Bloom filter</a>.</li>
<li>The false-positive rate MUST be 0.001.</li>
</ul>
<p>Calculation for filter bits is different and is nearly a factor of 10 lower than for a standard Bloom filter:
128*1024 rows with a 0.001 false-positive rate results in around 29,000 bits for a Split Block Bloom filter.</p>
<p>Bloom filters are ONLY added to some fields.
See also <a href="DSNP/Announcements.html">Announcement Types</a>.</p>
<h4 id="columns-with-bloom-filters"><a class="header" href="#columns-with-bloom-filters">Columns with Bloom Filters</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Column</th><th>Parquet Type</th></tr></thead><tbody>
<tr><td>contentHash</td><td><code>BYTE_ARRAY</code></td></tr>
<tr><td>emoji</td><td><code>BYTE_ARRAY</code></td></tr>
<tr><td>fromId</td><td><code>BYTE_ARRAY</code></td></tr>
<tr><td>inReplyTo</td><td><code>BYTE_ARRAY</code></td></tr>
<tr><td>objectId</td><td><code>BYTE_ARRAY</code></td></tr>
</tbody></table>
</div>
<h2 id="non-normative-1"><a class="header" href="#non-normative-1">Non-Normative</a></h2>
<h3 id="design-requirements"><a class="header" href="#design-requirements">Design Requirements</a></h3>
<p>Batch files need to be quickly and easily searchable.
Minimal storage size and fast, simple querying are preferred over guarantees of no false positives or advanced data manipulation and column relationships.
The files are parseable by client applications, web views, or browsers running pure JavaScript without needing to convert the format.</p>
<p>Applications need to know if a given Batch file has any information of interest without downloading the file first.</p>
<h3 id="why-parquet"><a class="header" href="#why-parquet">Why Parquet?</a></h3>
<ol>
<li>Parquet is a <strong>column-oriented format</strong>. Since DSNP Batch Message data will have a very small column-to-row ratio compared to a typical web application database, it makes sense to prefer a column-oriented format.</li>
<li>Parquet format <strong>has been field tested under extreme network conditions</strong>. It has broad support in cloud storage solutions, with libraries in multiple languages.</li>
<li><strong>Bloom filters are already supported</strong> in the Parquet specification, which allows for fast and accurate searching (with caveats for proper configuration).</li>
<li><strong>Amazon S3 support</strong>: We anticipate that some Batch Announcers (and possibly Archivists) will store Batch files on Amazon S3. Amazon Athena also supports storage in Parquet, and its API supports SQL-like queries.</li>
<li>Parquet also <strong>allows references to the same column across files</strong>, which could enable multi-file querying in the future.</li>
<li>Parquet <strong>supports compression formats</strong> such as Brötli, which is already a browser standard and offers a demonstrated improvement in compression speed and file size over older formats.</li>
<li>Parquet <strong>files can be transferred directly</strong> to clients, which can parse the files in the app or browser. No conversion to a serialization format is necessary. This eliminates an entire class of bugs and makes both fetching and querying faster.</li>
<li>Parquet <strong>uses schemas</strong>, which additionally reduce file size.</li>
</ol>
<h3 id="rejected-alternatives"><a class="header" href="#rejected-alternatives">Rejected Alternatives</a></h3>
<ol>
<li>Cassandra, RocksDB, CouchDB, MongoDB, and HBASE were rejected since DSNP data needs neither a database for storage nor the overhead of one. Each of these was designed for use cases ranging from somewhat different to drastically different from the DSNP network.</li>
<li>JSON, BSON, and SQLite, while sometimes used for storage, are intended for serialization. They are schemaless, which results in redundant information and therefore a larger size than formats with schemas. They also don't support Bloom filters; thus, indexing would be required, or new batches would need to be downloaded entirely.  The exception is SQLite, which does support more advanced queries. However, SQLite was designed for in-memory storage.</li>
</ol>
<h3 id="batch-validity-and-order"><a class="header" href="#batch-validity-and-order">Batch Validity and Order</a></h3>
<p>Batch validity is immutable and is usually based (in part) on the validation of the delegation of authors listed inside the batch to the publisher.
Due to the nature of distributed systems, it is possible that a race condition occurs such that a user's delegation revocation presents before a Batch that contains a message from that user via the revoked delegate.
While those individual messages should be considered invalid, a window of time for historical testing is suggested before considering the entire batch invalid.
This is analogous to the idea of a <a href="https://en.bitcoin.it/wiki/Confirmation">confirmation time</a>, but only applies to the past rather than the future.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="announcements-overview"><a class="header" href="#announcements-overview">Announcements Overview</a></h1>
<p>Announcements are content or references to content that communicate new user activity to the rest of the network.
Announcements are associated with an <a href="DSNP/Identifiers.html">Identifier</a> that can be validated as the creator of the Announcement.
Depending on the implementation, Announcements may be published directly to the network, included in <a href="DSNP/BatchPublications.html">Batch Publication Files</a>, or some combination of those two.</p>
<h2 id="announcement-types"><a class="header" href="#announcement-types">Announcement Types</a></h2>
<p>Each Announcement has an enumerated type for use when separating out a stream of Announcements.</p>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Name</th><th>Description</th><th>DSNP Content URI</th><th>Tombstone Allowed</th></tr></thead><tbody>
<tr><td>0</td><td><a href="DSNP/Types/Tombstone.html">Tombstone</a></td><td>an invalidation of previously announced content</td><td>no</td><td>no</td></tr>
<tr><td>1</td><td><del><a href="DSNP/Types/GraphChange.html">Graph Change</a></del><sup>a</sup></td><td><del>social graph changes</del></td><td><del>no</del></td><td><del>no</del></td></tr>
<tr><td>2</td><td><a href="DSNP/Types/Broadcast.html">Broadcast</a></td><td>a public post</td><td>YES</td><td>YES</td></tr>
<tr><td>3</td><td><a href="DSNP/Types/Reply.html">Reply</a></td><td>a public response to a Broadcast</td><td>YES</td><td>YES</td></tr>
<tr><td>4</td><td><a href="DSNP/Types/Reaction.html">Reaction</a></td><td>a public visual reply to a Broadcast</td><td>no</td><td>no</td></tr>
<tr><td>5</td><td><a href="DSNP/Types/Profile.html">Profile</a></td><td>a profile</td><td>YES</td><td>no</td></tr>
<tr><td>6</td><td><a href="DSNP/Types/Update.html">Update</a></td><td>an update to content</td><td>YES</td><td>no</td></tr>
<tr><td>7</td><td><a href="DSNP/Types/PublicKey.html">Public Key</a></td><td>a public key for secure communication</td><td>no</td><td>no</td></tr>
</tbody></table>
</div>
<p><sup>a</sup> Since DSNP version 1.2, social graph changes use <a href="DSNP/UserData.html">User Data</a> operations as described in the <a href="DSNP/Graph.html">Graph</a> section.</p>
<h2 id="announcement-validation"><a class="header" href="#announcement-validation">Announcement Validation</a></h2>
<p>There is no guarantee that, at time of creation, a given Announcement will be from the <code>fromId</code> claimed in the Announcement.
The reader MUST perform a validation of the Announcement at read time to ensure authenticity.
Implementations MUST provide a way to validate that the <a href="DSNP/Identifiers.html">identifier</a> associated with a given <a href="DSNP/Announcements.html">Announcement</a> is authentic.</p>
<h2 id="external-content-urls-and-hashes"><a class="header" href="#external-content-urls-and-hashes">External Content URLs and Hashes</a></h2>
<p>Where Announcements refer to external documents (such as Activity Content documents), these are referenced by both a URL and a <a href="DSNP/Identifiers.html#dsnp-content-hash">DSNP Content Hash</a>.
The content hash MUST be generated by applying a <a href="DSNP/Identifiers.html#supported-hashing-algorithms">Supported Hashing Algorithm</a> to the full, unaltered contents retrieved from the URL.
When readers retrieve content referenced in an Announcement, they can validate the authenticity of the content by regenerating the hash output and comparing it with the content hash recorded in the Announcement.</p>
<h2 id="duplicate-handling"><a class="header" href="#duplicate-handling">Duplicate Handling</a></h2>
<p>Due to the nature of asynchronous communication, duplicate Announcements may occur.
In the case of duplicates, the first Announcement should be considered the ONLY valid Announcement.
Additional duplicate Announcements MUST be rejected or ignored.</p>
<h2 id="ordering-announcements"><a class="header" href="#ordering-announcements">Ordering Announcements</a></h2>
<ol>
<li>Order Batch Publications by implementation order.</li>
<li>Order Announcements in a Batch Publication File by row appearance order.</li>
</ol>
<h2 id="reverting-an-announcement"><a class="header" href="#reverting-an-announcement">Reverting an Announcement</a></h2>
<p>Announcements may not be deleted, but may be marked invalid by using a <a href="DSNP/Types/Tombstone.html">Tombstone Announcement</a>, or updated by using an <a href="DSNP/Types/Update.html">Update Announcement</a>.
For example, if a user creates a <a href="DSNP/Types/Reaction.html">Reaction Announcement</a>, they may remove that reaction by creating a Tombstone Announcement.</p>
<h2 id="related-operations-1"><a class="header" href="#related-operations-1">Related Operations</a></h2>
<ul>
<li><a href="DSNP/Operations.html#PublishAnnouncement">Publish Announcement</a></li>
<li><a href="DSNP/Operations.html#PublishBatch">Publish Batch</a></li>
</ul>
<h2 id="non-normative-2"><a class="header" href="#non-normative-2">Non-Normative</a></h2>
<h3 id="duplicate-announcements"><a class="header" href="#duplicate-announcements">Duplicate Announcements</a></h3>
<p>Due to the distributed nature of DSNP, duplicate Announcements are possible from time to time.
These should be discarded and ignored.</p>
<h3 id="replay-attacks"><a class="header" href="#replay-attacks">Replay Attacks</a></h3>
<p>Implementations typically restrict replay attacks by testing that the chain transaction sender is authorized (often via delegation) to publish an Announcement.</p>
<h3 id="announcement-ordering-and-activity-content-published-timestamp"><a class="header" href="#announcement-ordering-and-activity-content-published-timestamp">Announcement Ordering and Activity Content Published Timestamp</a></h3>
<p>Activity Content has a published field that contains a user-generated timestamp.
User-generated timestamps cannot be validated, but may be used to indicate ordering other than the network order for Announcements (which are <em>not</em> time dependent.)</p>
<h3 id="announcement-reference-ordering"><a class="header" href="#announcement-reference-ordering">Announcement Reference Ordering</a></h3>
<p>Some Announcements contain references to other Announcements via the <code>inReplyTo</code> field.
Due to the distributed nature of DSNP, the canonical order can have an Announcement that refers to another Announcement appearing later in the network order.
For display purposes, these messages should be considered to have occurred after the reference.</p>
<h3 id="dsnp-v10-announcement-signatures"><a class="header" href="#dsnp-v10-announcement-signatures">DSNP v1.0 Announcement Signatures</a></h3>
<p>In DSNP v1.0, Announcements had individual signatures, producing Batch Publications that were generic and disconnected from the user.
Announcements could be submitted to the chain via anyone—not just delegates or users.</p>
<p>In DSNP v1.1, Announcement signatures were removed in favor of the implementation being responsible for the connection between the on-chain signature and the user.
Implementations require that the transaction that produces a Batch be performed by the user or delegate directly.
This creates batches that are delegate specific, but allows for faster testing of the validity of individual Announcements in a Batch.</p>
<p>For more information see <a href="https://github.com/LibertyDSNP/spec/issues/145">DIP-145</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tombstone-announcement"><a class="header" href="#tombstone-announcement">Tombstone Announcement</a></h1>
<p>A Tombstone Announcement is a way to note that a previously announced content is invalid and the related Announcement should be considered reverted.
It is NOT possible to revert a tombstone.</p>
<h2 id="fields"><a class="header" href="#fields">Fields</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th><th>Data Type</th><th>Serialization</th><th>Parquet Type</th><th>Bloom Filter</th></tr></thead><tbody>
<tr><td>announcementType</td><td>Announcement Type Enum (<code>0</code>)</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>fromId</td><td>Id of the user creating the Announcement and the Tombstoned Announcement</td><td>64-bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
<tr><td>targetAnnouncementType</td><td>target tombstoned Announcement type</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>targetContentHash</td><td>target <code>contentHash</code> of the original Announcement to tombstone</td><td>variable length byte array</td><td><a href="DSNP/Types/../Serializations.html#hexadecimal">hexadecimal</a></td><td><code>BYTE_ARRAY</code></td><td>YES</td></tr>
</tbody></table>
</div>
<h2 id="field-requirements"><a class="header" href="#field-requirements">Field Requirements</a></h2>
<h3 id="announcementtype"><a class="header" href="#announcementtype">announcementType</a></h3>
<ul>
<li>MUST be fixed to <code>0</code></li>
</ul>
<h3 id="fromid"><a class="header" href="#fromid">fromId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
<li>MUST have authorized the creation of the Announcement, either directly or via a transparent chain of delegation</li>
</ul>
<h3 id="targetannouncementtype"><a class="header" href="#targetannouncementtype">targetAnnouncementType</a></h3>
<ul>
<li>MUST be the <a href="DSNP/Types/../Announcements.html#announcement-types">Announcement Type</a> of the target Announcement</li>
<li>MUST ONLY be a Tombstone allowed Announcement Type</li>
</ul>
<h4 id="tombstone-allowed-announcement-types"><a class="header" href="#tombstone-allowed-announcement-types">Tombstone Allowed Announcement Types</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Name</th></tr></thead><tbody>
<tr><td>2</td><td><a href="DSNP/Types/../Types/Broadcast.html">Broadcast</a></td></tr>
<tr><td>3</td><td><a href="DSNP/Types/../Types/Reply.html">Reply</a></td></tr>
</tbody></table>
</div>
<h3 id="targetcontenthash"><a class="header" href="#targetcontenthash">targetContentHash</a></h3>
<ul>
<li>MUST match a <code>contentHash</code> of previous Announcement with the same <code>fromId</code> as the Tombstone Announcement</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="broadcast-announcement"><a class="header" href="#broadcast-announcement">Broadcast Announcement</a></h1>
<p>A Broadcast Announcement is a way to send a public message to everyone.</p>
<h2 id="fields-1"><a class="header" href="#fields-1">Fields</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th><th>Data Type</th><th>Serialization</th><th>Parquet Type</th><th>Bloom Filter</th></tr></thead><tbody>
<tr><td>announcementType</td><td>Announcement Type Enum (<code>2</code>)</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>contentHash</td><td>multihash-encoded hash of content stored at URL</td><td>variable length byte array</td><td><a href="DSNP/Types/../Serializations.html#hexadecimal">hexadecimal</a></td><td><code>BYTE_ARRAY</code></td><td>YES</td></tr>
<tr><td>fromId</td><td>id of the user creating the Announcement</td><td>64-bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
<tr><td>url</td><td>content URL</td><td>UTF-8</td><td><a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a></td><td><code>UTF8</code></td><td>no</td></tr>
</tbody></table>
</div>
<h2 id="field-requirements-1"><a class="header" href="#field-requirements-1">Field Requirements</a></h2>
<h3 id="announcementtype-1"><a class="header" href="#announcementtype-1">announcementType</a></h3>
<ul>
<li>MUST be fixed to <code>2</code></li>
</ul>
<h3 id="contenthash"><a class="header" href="#contenthash">contentHash</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-content-hash">DSNP Content Hash</a></li>
</ul>
<h3 id="fromid-1"><a class="header" href="#fromid-1">fromId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
<li>MUST have authorized the creation of the Announcement, either directly or via a transparent chain of delegation</li>
</ul>
<h3 id="url"><a class="header" href="#url">url</a></h3>
<ul>
<li>MUST NOT refer to localhost or any reserved IP addresses as defined in <a href="https://datatracker.ietf.org/doc/html/rfc6890">RFC6890</a></li>
<li>Resource MUST be one of the supported <a href="DSNP/Types/../../ActivityContent/Overview.html">Activity Content</a> Types</li>
<li>MUST use one of the supported URL Schemes</li>
</ul>
<h4 id="supported-url-schemes"><a class="header" href="#supported-url-schemes">Supported URL Schemes</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Scheme</th><th>Description</th><th>Reference</th><th>DSNP Version Added</th></tr></thead><tbody>
<tr><td>HTTPS</td><td>Hypertext Transfer Protocol Secure</td><td><a href="https://datatracker.ietf.org/doc/html/rfc2818">RFC2818</a></td><td>1.0</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="reply-announcement"><a class="header" href="#reply-announcement">Reply Announcement</a></h1>
<p>A Reply Announcement is the same as a <a href="DSNP/Types/../Types/Broadcast.html">Broadcast Announcement</a>,
but includes an <code>inReplyTo</code> field for noting it as a reply to a given <a href="DSNP/Types/../Identifiers.html#dsnp-content-uri">DSNP Content URI</a>.</p>
<h2 id="fields-2"><a class="header" href="#fields-2">Fields</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th><th>Data Type</th><th>Serialization</th><th>Parquet Type</th><th>Bloom Filter</th></tr></thead><tbody>
<tr><td>announcementType</td><td>Announcement Type Enum (<code>3</code>)</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>contentHash</td><td>multihash-encoded hash of content stored at URL</td><td>variable length byte array</td><td><a href="DSNP/Types/../Serializations.html#hexadecimal">hexadecimal</a></td><td><code>BYTE_ARRAY</code></td><td>YES</td></tr>
<tr><td>fromId</td><td>id of the user creating the Announcement</td><td>64-bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
<tr><td>inReplyTo</td><td>Target <a href="DSNP/Types/../Identifiers.html#dsnp-content-uri">DSNP Content URI</a></td><td>UTF-8</td><td><a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a></td><td><code>UTF8</code></td><td>YES</td></tr>
<tr><td>url</td><td>content URL</td><td>UTF-8</td><td><a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a></td><td><code>UTF8</code></td><td>no</td></tr>
</tbody></table>
</div>
<h2 id="field-requirements-2"><a class="header" href="#field-requirements-2">Field Requirements</a></h2>
<h3 id="announcementtype-2"><a class="header" href="#announcementtype-2">announcementType</a></h3>
<ul>
<li>MUST be fixed to <code>3</code></li>
</ul>
<h3 id="contenthash-1"><a class="header" href="#contenthash-1">contentHash</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-content-hash">DSNP Content Hash</a></li>
</ul>
<h3 id="fromid-2"><a class="header" href="#fromid-2">fromId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
<li>MUST have authorized the creation of the Announcement, either directly or via a transparent chain of delegation</li>
</ul>
<h3 id="inreplyto"><a class="header" href="#inreplyto">inReplyTo</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-content-uri">DSNP Content URI</a></li>
</ul>
<h3 id="url-1"><a class="header" href="#url-1">url</a></h3>
<ul>
<li>MUST NOT refer to localhost or any reserved IP addresses as defined in <a href="https://datatracker.ietf.org/doc/html/rfc6890">RFC6890</a></li>
<li>Resource MUST be one of the supported <a href="DSNP/Types/../../ActivityContent/Overview.html">Activity Content</a> Types</li>
<li>MUST use one of the supported URL Schemes</li>
</ul>
<h4 id="supported-url-schemes-1"><a class="header" href="#supported-url-schemes-1">Supported URL Schemes</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Scheme</th><th>Description</th><th>Reference</th><th>DSNP Version Added</th></tr></thead><tbody>
<tr><td>HTTPS</td><td>Hypertext Transfer Protocol Secure</td><td><a href="https://datatracker.ietf.org/doc/html/rfc2818">RFC2818</a></td><td>1.0</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="reaction-announcement"><a class="header" href="#reaction-announcement">Reaction Announcement</a></h1>
<p>A Reaction Announcement is for publishing emoji reactions to anything with a <a href="DSNP/Types/../Identifiers.html#dsnp-content-uri">DSNP Content URI</a>.</p>
<h2 id="fields-3"><a class="header" href="#fields-3">Fields</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th><th>Data Type</th><th>Serialization</th><th>Parquet Type</th><th>Bloom Filter</th></tr></thead><tbody>
<tr><td>announcementType</td><td>Announcement Type Enum (<code>4</code>)</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>emoji</td><td>the encoded reaction</td><td>UTF-8</td><td><a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a></td><td><code>UTF8</code></td><td>YES</td></tr>
<tr><td>apply</td><td>how to apply the reaction</td><td>8-bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_8</code></td><td>no</td></tr>
<tr><td>fromId</td><td>id of the user creating the relationship</td><td>64-bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
<tr><td>inReplyTo</td><td>Target <a href="DSNP/Types/../Identifiers.html#dsnp-content-uri">DSNP Content URI</a></td><td>UTF-8</td><td><a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a></td><td><code>UTF8</code></td><td>YES</td></tr>
</tbody></table>
</div>
<h2 id="field-requirements-3"><a class="header" href="#field-requirements-3">Field Requirements</a></h2>
<h3 id="announcementtype-3"><a class="header" href="#announcementtype-3">announcementType</a></h3>
<ul>
<li>MUST be fixed to <code>4</code></li>
</ul>
<h3 id="emoji"><a class="header" href="#emoji">emoji</a></h3>
<ul>
<li>Emoji fields must not be empty</li>
<li>Emoji fields must consist only of <a href="https://unicode.org/standard/standard.html">Unicode points</a> from <code>U+2000</code> to <code>U+2BFF</code>, from <code>U+E000</code> to <code>U+FFFF</code>, or from <code>U+1F000</code> to <code>U+10FFFF</code></li>
</ul>
<h4 id="examples-2"><a class="header" href="#examples-2">Examples</a></h4>
<p>All of the following should be considered valid emojis:</p>
<pre><code>&quot;😀&quot;, &quot;🤌🏼&quot;, &quot;👩🏻‍🎤&quot;, &quot;🧑🏿‍🏫&quot;, &quot;🏳️‍🌈&quot;, &quot;🏳️‍⚧️&quot;, &quot;⚛︎&quot;, &quot;🃑&quot;, &quot;♻︎&quot;
</code></pre>
<p>None of the following should be considered valid:</p>
<pre><code>&quot;F&quot;, &quot;:custom-emoji:&quot;, &quot;&lt;custom-emoji&gt;&quot;, &quot;ᚱ&quot;, &quot;ᘐ&quot;, &quot;״&quot;
</code></pre>
<h3 id="apply"><a class="header" href="#apply">apply</a></h3>
<ul>
<li>MUST be an UINT_8</li>
<li>Indicates whether the emoji should be applied and if so, at what &quot;strength&quot;.</li>
</ul>
<p>Potential uses:</p>
<ul>
<li>a single reaction</li>
<li>ratings</li>
<li>a range of responses, e.g. &quot;strongly disagree&quot; --&gt; &quot;strongly agree&quot; = 1 --&gt; 5 stars.</li>
<li>recommendation engines</li>
</ul>
<h4 id="apply-enums"><a class="header" href="#apply-enums">Apply Enums</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>0</td><td>retract</td><td>Remove the referenced emoji</td></tr>
<tr><td>n</td><td>apply</td><td>Apply the referenced emoji N times</td></tr>
</tbody></table>
</div>
<h3 id="fromid-3"><a class="header" href="#fromid-3">fromId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
<li>MUST have authorized the creation of the Announcement, either directly or via a transparent chain of delegation</li>
</ul>
<h3 id="inreplyto-1"><a class="header" href="#inreplyto-1">inReplyTo</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-content-uri">DSNP Content URI</a></li>
</ul>
<h2 id="non-normative-3"><a class="header" href="#non-normative-3">Non-Normative</a></h2>
<h3 id="likes"><a class="header" href="#likes">Likes</a></h3>
<p>Generic &quot;likes&quot; should default to the <code>&quot;❤️&quot;</code> or Unicode <code>U+FE0F</code> as the emoji in the reaction.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="profile-announcement"><a class="header" href="#profile-announcement">Profile Announcement</a></h1>
<p>A Profile Announcement is a constrained version of a <a href="DSNP/Types/../Types/Broadcast.html">Broadcast Announcement</a>.
The reference content <em>MUST be of profile type</em>.</p>
<h2 id="fields-4"><a class="header" href="#fields-4">Fields</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th><th>Data Type</th><th>Serialization</th><th>Parquet Type</th><th>Bloom Filter</th></tr></thead><tbody>
<tr><td>announcementType</td><td>Announcement Type Enum (<code>5</code>)</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>contentHash</td><td>multihash-encoded hash of content stored at URL</td><td>variable length byte array</td><td><a href="DSNP/Types/../Serializations.html#hexadecimal">hexadecimal</a></td><td><code>BYTE_ARRAY</code></td><td>YES</td></tr>
<tr><td>fromId</td><td>id of the user creating the Announcement</td><td>64-bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
<tr><td>url</td><td>profile content URL</td><td>UTF-8</td><td><a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a></td><td><code>UTF8</code></td><td>no</td></tr>
</tbody></table>
</div>
<h2 id="field-requirements-4"><a class="header" href="#field-requirements-4">Field Requirements</a></h2>
<h3 id="announcementtype-4"><a class="header" href="#announcementtype-4">announcementType</a></h3>
<ul>
<li>MUST be fixed to <code>5</code></li>
</ul>
<h3 id="contenthash-2"><a class="header" href="#contenthash-2">contentHash</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-content-hash">DSNP Content Hash</a></li>
</ul>
<h3 id="fromid-4"><a class="header" href="#fromid-4">fromId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
<li>MUST have authorized the creation of the Announcement, either directly or via a transparent chain of delegation</li>
</ul>
<h3 id="url-2"><a class="header" href="#url-2">url</a></h3>
<ul>
<li>MUST NOT refer to localhost or any reserved IP addresses as defined in <a href="https://datatracker.ietf.org/doc/html/rfc6890">RFC6890</a></li>
<li>Resource MUST be a valid <a href="DSNP/Types/../../ActivityContent/Types/Profile.html">Profile Activity Content</a> Type</li>
<li>MUST use one of the supported URL Schemes</li>
</ul>
<h4 id="supported-url-schemes-2"><a class="header" href="#supported-url-schemes-2">Supported URL Schemes</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Scheme</th><th>Description</th><th>Reference</th><th>DSNP Version Added</th></tr></thead><tbody>
<tr><td>HTTPS</td><td>Hypertext Transfer Protocol Secure</td><td><a href="https://datatracker.ietf.org/doc/html/rfc2818">RFC2818</a></td><td>1.0</td></tr>
</tbody></table>
</div>
<h2 id="non-normative-4"><a class="header" href="#non-normative-4">Non-Normative</a></h2>
<h3 id="most-recent-profile"><a class="header" href="#most-recent-profile">Most Recent Profile</a></h3>
<p>When displaying a DSNP user's profile, the most recent profile should be considered the complete and correct version.
Previous Profile Announcements from the same <code>fromId</code> may be disregarded.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="update-announcement"><a class="header" href="#update-announcement">Update Announcement</a></h1>
<p>An Update Announcement is a way to note intent to update previously
announced content. If the original Broadcast/Reply is Tombstoned, subsequent
Updates should be ignored.</p>
<h2 id="fields-5"><a class="header" href="#fields-5">Fields</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th><th>Data Type</th><th>Serialization</th><th>Parquet Type</th><th>Bloom Filter</th></tr></thead><tbody>
<tr><td>announcementType</td><td>Announcement Type Enum (<code>6</code>)</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>fromId</td><td>id of the user creating the announcement</td><td>64 bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
<tr><td>contentHash</td><td>multihash-encoded hash of content stored at URL</td><td>variable length byte array</td><td><a href="DSNP/Types/../Serializations.html#hexadecimal">hexadecimal</a></td><td><code>BYTE_ARRAY</code></td><td>YES</td></tr>
<tr><td>url</td><td>updated content URL</td><td>UTF-8</td><td><a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a></td><td><code>UTF8</code></td><td>no</td></tr>
<tr><td>targetAnnouncementType</td><td>target updated Announcement type</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>targetContentHash</td><td>multihash-encoded hash of target content</td><td>variable length byte array</td><td><a href="DSNP/Types/../Serializations.html#hexadecimal">hexadecimal</a></td><td><code>BYTE_ARRAY</code></td><td>YES</td></tr>
</tbody></table>
</div>
<h2 id="field-requirements-5"><a class="header" href="#field-requirements-5">Field Requirements</a></h2>
<h3 id="announcementtype-5"><a class="header" href="#announcementtype-5">announcementType</a></h3>
<ul>
<li>MUST be fixed to <code>6</code></li>
</ul>
<h3 id="fromid-5"><a class="header" href="#fromid-5">fromId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
</ul>
<h3 id="contenthash-3"><a class="header" href="#contenthash-3">contentHash</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-content-hash">DSNP Content Hash</a> </li>
</ul>
<h3 id="url-3"><a class="header" href="#url-3">url</a></h3>
<ul>
<li>MUST NOT refer to localhost or any reserved IP addresses as defined in <a href="https://datatracker.ietf.org/doc/html/rfc6890">RFC6890</a></li>
<li>Resource MUST be one of the supported <a href="DSNP/Types/../../ActivityContent/Overview.html">Activity Content</a> Types</li>
<li>MUST use one of the supported URL Schemes</li>
</ul>
<h3 id="targetannouncementtype-1"><a class="header" href="#targetannouncementtype-1">targetAnnouncementType</a></h3>
<ul>
<li>MUST be the <a href="DSNP/Types/../Announcements.html#announcement-types">Announcement Type</a> of the target Announcement</li>
<li>MUST ONLY be an Update allowed Announcement Type</li>
</ul>
<h4 id="update-allowed-announcement-types"><a class="header" href="#update-allowed-announcement-types">Update Allowed Announcement Types</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Name</th></tr></thead><tbody>
<tr><td>2</td><td><a href="DSNP/Types/../Types/Broadcast.html">Broadcast</a></td></tr>
<tr><td>3</td><td><a href="DSNP/Types/../Types/Reply.html">Reply</a></td></tr>
</tbody></table>
</div>
<h3 id="targetcontenthash-1"><a class="header" href="#targetcontenthash-1">targetContentHash</a></h3>
<ul>
<li>MUST be the <code>contentHash</code> of an allowed Announcement type with the same <code>fromId</code> as the Update Announcement</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="public-key-announcement"><a class="header" href="#public-key-announcement">Public Key Announcement</a></h1>
<p>A Public Key Announcement is a way to note a new cryptographic key that can be used in DSNP to secure and verify the authenticity of communications.</p>
<p>The most recently published key (if one exists) for a given key type should be treated as the active key of that key type.</p>
<h2 id="fields-6"><a class="header" href="#fields-6">Fields</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th><th>Data Type</th><th>Serialization</th><th>Parquet Type</th><th>Bloom Filter</th></tr></thead><tbody>
<tr><td>announcementType</td><td>Announcement Type Enum (<code>7</code>)</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>fromId</td><td>id of the user creating the Announcement</td><td>64 bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
<tr><td>keyType</td><td>Key Type Enum</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>YES</td></tr>
<tr><td>keyId</td><td>user-assigned identifier</td><td>64 bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>no</td></tr>
<tr><td>publicKey</td><td>public key in multikey format</td><td>variable length byte array</td><td><a href="https://datatracker.ietf.org/doc/html/rfc3629">UTF-8</a></td><td><code>BYTE_ARRAY</code></td><td>no</td></tr>
</tbody></table>
</div>
<h2 id="field-requirements-6"><a class="header" href="#field-requirements-6">Field Requirements</a></h2>
<h3 id="announcementtype-6"><a class="header" href="#announcementtype-6">announcementType</a></h3>
<ul>
<li>MUST be fixed to <code>7</code></li>
</ul>
<h3 id="fromid-6"><a class="header" href="#fromid-6">fromId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
</ul>
<h3 id="keytype"><a class="header" href="#keytype">keyType</a></h3>
<ul>
<li>MUST be an allowed Key Type value</li>
</ul>
<h4 id="allowed-key-types"><a class="header" href="#allowed-key-types">Allowed Key Types</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Name</th><th>Allowed Algorithms (<a href="https://github.com/multiformats/multicodec/blob/master/table.csv">multicodec</a>)</th><th>Purpose</th></tr></thead><tbody>
<tr><td>1</td><td><code>keyAgreement</code></td><td><code>x25519-pub</code></td><td>A Curve25519 public key that can be used in key exchange protocols to generate a shared secret</td></tr>
</tbody></table>
</div>
<h3 id="keyid"><a class="header" href="#keyid">keyId</a></h3>
<ul>
<li>A user-assigned 64-bit identifier for the key.</li>
</ul>
<p>The user may assign a new <code>keyId</code> each time they announce a new key of a given <code>keyType</code>.
A <code>keyId</code> value is useful when invoking certain DSNP Operations in order to indicate which key was used to encrypt data.
It may also provide a hint to the user if they ever need to regenerate their private key (for example, many key derivation functions enable the use of a subkey identifier to deterministically create a subkey from a root key).</p>
<h3 id="publickey"><a class="header" href="#publickey">publicKey</a></h3>
<ul>
<li>MUST be a public key of an allowed algorithm for <code>keyType</code>, encoded in <code>multikey</code> format</li>
</ul>
<p>The <code>multikey</code> encoding of public keys is described in the draft <a href="https://w3c-ccg.github.io/did-method-key/">did:key Method</a> specification.
The byte encoding consists of a <a href="https://github.com/multiformats/multicodec/blob/master/table.csv">multicodec</a> key identifier (as a varint) followed by the public key's binary data in the codec's described format.</p>
<p>If serializing the <code>multicodec</code> value as a string, <code>base58btc</code> encoding is recommended.
For example, the string <code>z6LStiZsmxiK4odS4Sb6JmdRFuJ6e1SYP157gtiCyJKfrYha</code> decodes as a Base58 string using the <code>x25519-pub</code> multicodec value with a 32-byte raw key of <code>0xfd3384e132ad02a56c78f45547ee40038dc79002b90d29ed90e08eee762ae715</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="migrated-announcements"><a class="header" href="#migrated-announcements">Migrated Announcements</a></h1>
<ul>
<li><a href="DSNP/Types/GraphChange.html">Graph Change</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graph-change-announcement"><a class="header" href="#graph-change-announcement">Graph Change Announcement</a></h1>
<p><mark><em>Since DSNP version 1.2, social graph changes use <a href="DSNP/Types/../UserData.html">User Data</a> operations as described in the <a href="DSNP/Types/../Graph.html">Graph</a> section.</em></mark></p>
<p>A Graph Change Announcement is for publishing relationship state changes for a user.</p>
<h2 id="fields-7"><a class="header" href="#fields-7">Fields</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th><th>Data Type</th><th>Serialization</th><th>Parquet Type</th><th>Bloom Filter</th></tr></thead><tbody>
<tr><td>announcementType</td><td>Announcement Type Enum (<code>1</code>)</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>changeType</td><td>Type of relationship change</td><td>enum</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>INT32</code></td><td>no</td></tr>
<tr><td>fromId</td><td>Id of the user creating the relationship</td><td>64-bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
<tr><td>objectId</td><td>Id of the target of the relationship</td><td>64-bit unsigned integer</td><td><a href="DSNP/Types/../Serializations.html#decimal">decimal</a></td><td><code>UINT_64</code></td><td>YES</td></tr>
</tbody></table>
</div>
<h2 id="field-requirements-7"><a class="header" href="#field-requirements-7">Field Requirements</a></h2>
<h3 id="announcementtype-7"><a class="header" href="#announcementtype-7">announcementType</a></h3>
<ul>
<li>MUST be fixed to <code>1</code></li>
</ul>
<h3 id="changetype"><a class="header" href="#changetype">changeType</a></h3>
<ul>
<li>MUST be one of the Change Type Enum</li>
</ul>
<h3 id="change-type-enum"><a class="header" href="#change-type-enum">Change Type Enum</a></h3>
<p>Different change types have different meanings.</p>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>0</td><td>Unfollow</td><td>Remove a Follow relationship</td></tr>
<tr><td>1</td><td>Follow</td><td>Create a Follow relationship</td></tr>
</tbody></table>
</div>
<h3 id="fromid-7"><a class="header" href="#fromid-7">fromId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
<li>MUST have authorized the creation of the Announcement, either directly or via a transparent chain of delegation</li>
</ul>
<h3 id="objectid"><a class="header" href="#objectid">objectId</a></h3>
<ul>
<li>MUST be a <a href="DSNP/Types/../Identifiers.html#dsnp-user-id">DSNP User Id</a></li>
</ul>
<h2 id="non-normative-5"><a class="header" href="#non-normative-5">Non-Normative</a></h2>
<h3 id="graph-retrieval-ordering-and-reading"><a class="header" href="#graph-retrieval-ordering-and-reading">Graph Retrieval, Ordering and Reading</a></h3>
<p>Each Graph Change event represents a state transition for the graph.
The state of the graph at any time is given by taking the state of the graph at a previous time and applying all Graph Change events not previously applied in the order specified by <a href="DSNP/Types/../Announcements.html#ordering-announcements">Announcement Ordering</a>.</p>
<p>Once those Graph Change events are retrieved, they can be ordered to reflect the current graph state
(i.e. Charlie has followed Bob, then he unfollowed him, and then followed him again. The graph state reflects that Charlie is following Bob.)</p>
<p>To retrieve the graph, do the following:</p>
<ol>
<li>Retrieve the events with <a href="DSNP/Types/../Announcements.html#announcement-types">announcementType</a> matching the enum for Graph Change.</li>
<li>Filter the events to a particular DSNP User Id to retrieve information about the respective graph.</li>
<li>Order the retrieved data by <a href="DSNP/Types/../Announcements.html#ordering-announcements">Announcement Ordering</a>.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operations"><a class="header" href="#operations">Operations</a></h1>
<p>DSNP implementations perform well-defined DSNP Operations and generate DSNP State Change Records.</p>
<h2 id="control-keys-and-proofs"><a class="header" href="#control-keys-and-proofs">Control Keys and Proofs</a></h2>
<p>Each invocation of a DSNP Operation MUST have verifiable approval of the acting principal(s) via a Control Key Ownership Proof.
The precise data type and representation of both the Control Key and the Control Key Ownership Proof MUST be defined by each DSNP implementation.
For example, an implementation might use the public key of an asymmetric key pair as a control key, and provide a proof for each operation by producing a cryptographic signature of the user's DSNP Identifier and some nonce value.</p>
<p>Where operations are listed as using control keys or ownership proofs as input parameters, this indicates that these keys or proofs should be provided in addition to those needed for invocation authentication.</p>
<h2 id="transaction-identifiers"><a class="header" href="#transaction-identifiers">Transaction Identifiers</a></h2>
<p>Each invocation of a DSNP Operation should be associated with a Transaction Identifier.
Transaction Identifiers are used to  associate Operation invocations with asynchronously emitted State Change Records.
It MUST be possible to associate a DSNP State Change Record with a Transaction Identifier from a particular DSNP Operation invocation.
Transaction Identifiers MUST be unique within an implementation.
Transaction Identifiers MUST be serializable as a string.</p>
<h2 id="failure-handling"><a class="header" href="#failure-handling">Failure Handling</a></h2>
<p>Compliant implementations may respond to error conditions either synchronously, as a response to the invocation request, or asynchronously, by emitting a <a href="DSNP/Records.html#failure">Failure Record</a>.</p>
<h2 id="list-of-operations"><a class="header" href="#list-of-operations">List of Operations</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Optional?</th><th>Principal(s)</th><th>Inputs</th><th>State Change Record or Output</th></tr></thead><tbody>
<tr><td><a id="create-identifier">Create Identifier</a></td><td>no</td><td>None</td><td>Control Key, Control Key Ownership Proof</td><td><a href="DSNP/Records.html#identifier-creation">Identifier Creation Record</a></td></tr>
<tr><td><a id="retire-identifier">Retire Identifier</a></td><td>no</td><td>User</td><td>None</td><td><a href="DSNP/Records.html#identifier-retirement">Identifier Retirement Record</a></td></tr>
<tr><td><a id="define-delegation">Define Delegation</a></td><td>no</td><td>User AND Delegate</td><td>User's Identifier, Delegate's Identifier, Set of Allowed <a href="DSNP/Announcements.html#announcement-types">Announcement Types</a>, Set of Allowed <a href="DSNP/UserData.html">User Data Types</a></td><td><a href="DSNP/Records.html#delegation-definition">Delegation Definition Record</a></td></tr>
<tr><td><a id="revoke-delegation">Revoke Delegation</a></td><td>no</td><td>User OR Delegate</td><td>User's Identifier, Delegate's Identifier</td><td><a href="DSNP/Records.html#delegation-revocation">Delegation Revocation Record</a></td></tr>
<tr><td><a id="add-control-key">Add Control Key</a></td><td>YES</td><td>User</td><td>Key, Key Ownership Proof</td><td><a href="DSNP/Records.html#control-key-addition">Control Key Addition Record</a></td></tr>
<tr><td><a id="remove-control-key">Remove Control Key</a></td><td>YES</td><td>User</td><td>Key</td><td><a href="DSNP/Records.html#control-key-removal">Control Key Removal Record</a></td></tr>
<tr><td><a id="publish-announcement">Publish Announcement</a></td><td>no*</td><td>User OR Delegate</td><td><a href="DSNP/Announcements.html">Announcement</a></td><td><a href="DSNP/Records.html#announcement-published">Announcement Published Record</a></td></tr>
<tr><td><a id="publish-batch">Publish Batch</a></td><td>no*</td><td>User OR Delegate</td><td><a href="DSNP/Announcements.html#announcement-types">Announcement Type</a>, <a href="DSNP/BatchPublications.html">Batch Publication</a> URL, Batch Publication Content Hash</td><td><a href="DSNP/Records.html#batch-published">Batch Published Record</a></td></tr>
<tr><td><a id="get-user-data">Get User Data</a></td><td>no</td><td>Any</td><td>User's Identifier, Set of Requested <a href="DSNP/UserData.html#user-data-types">User Data Types</a></td><td>Map of <a href="DSNP/UserData.html#user-data-types">User Data Types</a> to <a href="DSNP/UserData.html#data-chunks">Data Chunks</a> with optional <a href="DSNP/Types/PublicKey.html#keyid">Key Identifiers</a></td></tr>
<tr><td><a id="replace-user-data">Replace User Data</a></td><td>no</td><td>User OR Delegate</td><td>User's Identifier, <a href="DSNP/Types/PublicKey.html#keyid">Key Identifier</a>, Map of <a href="DSNP/UserData.html#user-data-types">User Data Types</a> to <a href="DSNP/UserData.html#data-chunks">Data Chunks</a></td><td><a href="DSNP/Records.html#user-data-replaced">User Data Replaced Record</a></td></tr>
</tbody></table>
</div>
<p>* For each Announcement Type, an implementation may support one or both of these operations.
Implementations MUST document which of the operations is available for each Announcement Type.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="state-change-records"><a class="header" href="#state-change-records">State Change Records</a></h1>
<p>State Change Records constitute the observable output of a DSNP system.
Implementations MUST specify how applications can translate implementation-specific output into State Change Records.</p>
<p>Each Record is associated with a Transaction Identifier, which allows <a href="DSNP/Operations.html">Operations</a> to be asynchronously associated with their results.</p>
<p>Records consists of one or more fields.</p>
<!-- Raw HTML is required to do rowspans -->
<div class="table-wrapper">
<table>
<thead>
<tr>
<th align="left">Record Type</th>
<th>Field</th>
<th>Field Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="2"><a id="identifier-creation">Identifier Creation Record</a></td>
<td>Control Key</td>
<td><i>Implementation dependent</i></td>
</tr>
<tr>
<td>Control Key Ownership Proof</td>
<td><i>Implementation dependent</i></td>
</tr>
<tr>
<td rowspan="1"><a id="identifier-retirement">Identifier Retirement Record</a></td>
<td>User's Identifier</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td rowspan="4"><a id="delegation-definition">Delegation Definition Record</a></td>
<td>User Id</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td>Delegate Id</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td>Allowed Announcement Types</td>
<td>List of <a href="DSNP/Announcements.html#announcement-types">enum values</a></td>
</tr>
<tr>
<td>Allowed User Data Types</td>
<td>List of <a href="DSNP/UserData.html">enum values</a></td>
</tr>
<tr>
<td rowspan="2"><a id="delegation-revocation">Delegation Revocation Record</a></td>
<td>User Id</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td>Delegate Id</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td rowspan="3"><a id="control-key-addition">Control Key Addition Record</a></td>
<td>User Id</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td>Key</td>
<td><i>Implementation dependent</i></td>
</tr>
<tr>
<td>Key Ownership Proof</td>
<td><i>Implementation dependent</i></td>
</tr>
<tr>
<td rowspan="2"><a id="control-key-removal">Control Key Removal Record</a></td>
<td>User Id</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td>Key</td>
<td><i>Implementation dependent</i></td>
</tr>
<tr>
<td rowspan="1"><a id="announcement-published">Announcement Published Record</a></td>
<td>Announcement</td>
<td><i>One of the types described in</i> <a href="DSNP/Announcements.html">Announcements</a></td>
</tr>
<tr>
<td rowspan="4"><a id="batch-published">Batch Published Record</a></td>
<td>From Id</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td>Announcement Type</td>
<td><a href="DSNP/Announcements.html#announcement-types">Enum value</a></td>
</tr>
<tr>
<td>URL</td>
<td>String</td>
</tr>
<tr>
<td>Content Hash</td>
<td><a href="DSNP/Identifiers.html#dsnp-content-hash">DSNP Content Hash</a></td>
</tr>
<tr>
<td rowspan="1"><a id="failure">Failure Record</a></td>
<td>Message</td>
<td>String</td>
</tr>
<tr>
<td rowspan="2"><a id="user-data-replaced">User Data Replaced Record</a></td>
<td>User Id</td>
<td><a href="DSNP/Identifiers.html#dsnp-user-id">DSNP User Id</a></td>
</tr>
<tr>
<td>User Data Types</td>
<td>Set of <a href="DSNP/UserData.html#user-data-types">User Data Types</a></td>
</tr>
</tbody>
</table>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="serializations"><a class="header" href="#serializations">Serializations</a></h1>
<p>Serialization is how the value should be stringified for signing and for transfer between systems.
Most serializations use outside standards, but some requiring additional clarifications are provided here.</p>
<h2 id="decimal"><a class="header" href="#decimal">decimal</a></h2>
<p>Used to represent integers.
Strings are used to avoid issues with different implementations of numbers.</p>
<ul>
<li>MUST use 0-9 representation</li>
<li>MUST NOT have spaces or separators</li>
<li>MUST be a string</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Invalid</th><th>Why</th><th>Valid</th></tr></thead><tbody>
<tr><td><code>0x123</code></td><td>Must be decimal</td><td><code>&quot;291&quot;</code></td></tr>
<tr><td>291</td><td>Must be a string</td><td><code>&quot;291&quot;</code></td></tr>
<tr><td><code>291n</code></td><td><code>BigInt(291)</code> serialization appends an <code>n</code></td><td><code>&quot;291&quot;</code></td></tr>
</tbody></table>
</div>
<h2 id="hexadecimal"><a class="header" href="#hexadecimal">hexadecimal</a></h2>
<p>Used to represent bytes.</p>
<ul>
<li>MUST use 0-9 and a-f representation</li>
<li>MUST be lowercase</li>
<li>MUST be prefixed with a <code>0x</code></li>
<li>MUST NOT have spaces or separators</li>
<li>MUST have two characters per byte in addition to the <code>0x</code> characters</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Bytes</th><th>Invalid</th><th>Valid</th></tr></thead><tbody>
<tr><td>2</td><td><code>0x123</code></td><td><code>0x0123</code></td></tr>
<tr><td>2</td><td><code>123h</code></td><td><code>0x0123</code></td></tr>
<tr><td>2</td><td><code>0x0ABC</code></td><td><code>0x0abc</code></td></tr>
<tr><td>8</td><td><code>0xabc</code></td><td><code>0x0000000000000abc</code></td></tr>
<tr><td>32</td><td><code>0x3e34c4325f4461b9355027b314f3eb56d31af549f7da7bd9ef1ce951651e</code></td><td><code>0x00003e34c4325f4461b9355027b314f3eb56d31af549f7da7bd9ef1ce951651e</code></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="dsnp-systems"><a class="header" href="#dsnp-systems">DSNP Systems</a></h1>
<ul>
<li><a href="Frequency/Overview.html">Frequency</a> (Official)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dsnp-over-frequency"><a class="header" href="#dsnp-over-frequency">DSNP Over Frequency</a></h1>
<h2 id="language-and-framework"><a class="header" href="#language-and-framework">Language and Framework</a></h2>
<p>Frequency is a Polkadot Parachain written in Rust, using the Substrate framework.</p>
<ul>
<li><a href="https://www.frequency.xyz">Frequency Website</a></li>
<li><a href="https://github.com/LibertyDSNP/frequency">Frequency GitHub</a></li>
<li><a href="https://docs.frequency.xyz">Frequency Documentation</a></li>
<li><a href="https://libertydsnp.github.io/frequency/">Frequency Rust Documentation</a></li>
<li>Helpful Links
<ul>
<li><a href="https://wiki.polkadot.network/docs/getting-started">Getting Started - Polkadot Wiki</a></li>
<li><a href="https://wiki.polkadot.network/docs/learn-parachains">Parachains - Polkadot Wiki</a></li>
<li><a href="https://paritytech.github.io/substrate/master/">Substrate Rust Docs</a></li>
<li><a href="https://www.rust-lang.org/">Rust-lang.org</a></li>
</ul>
</li>
</ul>
<h2 id="dsnp-over-frequency-schemas"><a class="header" href="#dsnp-over-frequency-schemas">DSNP Over Frequency Schemas</a></h2>
<p>Official schemas may be found in <a href="https://github.com/LibertyDSNP/schemas">GitHub</a>.</p>
<!-- These ids are duplicated here for quick reference. -->
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Schema Id Mainnet</th><th>Schema Id Rococo</th></tr></thead><tbody>
<tr><td><a href="Frequency/./Publishing.html">Tombstone</a></td><td>1</td><td>1</td></tr>
<tr><td><a href="Frequency/./Publishing.html">Broadcast</a></td><td>2</td><td>2</td></tr>
<tr><td><a href="Frequency/./Publishing.html">Reply</a></td><td>3</td><td>3</td></tr>
<tr><td><a href="Frequency/./Publishing.html">Reaction</a></td><td>4</td><td>4</td></tr>
<tr><td><a href="Frequency/./Publishing.html">Profile</a></td><td>6</td><td>5</td></tr>
<tr><td><a href="Frequency/./Publishing.html">Update</a></td><td>5</td><td>6</td></tr>
<tr><td><a href="Frequency/./Publishing.html">Public Key</a></td><td>TBD</td><td>18</td></tr>
<tr><td><a href="Frequency/./UserData.html">Public Follows</a></td><td>TBD</td><td>13</td></tr>
<tr><td><a href="Frequency/./UserData.html">Private Follows</a></td><td>TBD</td><td>14</td></tr>
<tr><td><a href="Frequency/./UserData.html">Private Connections</a></td><td>TBD</td><td>15</td></tr>
</tbody></table>
</div><!--
### Obsolete

| Name | Mainnet Block Obsoleted | Schema Id Mainnet | Schema Id Rococo |
| --- | --- | --- | --- |
| TBD | TBD | 0 | 0 |

-->
<!--- Uncomment for pre-release changes
## Prerelease Changelog

- [DIP-###](https://github.com/LibertyDSNP/spec/issues/###)

--->
<div class="table-wrapper"><table><thead><tr><th>Last Update Date</th><th>Frequency Release</th><th>DSNP Version</th></tr></thead><tbody>
<tr><td>2023-04-19</td><td>1.5.2+</td><td>1.2.0</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="frequency-identity"><a class="header" href="#frequency-identity">Frequency Identity</a></h1>
<h2 id="identity-1"><a class="header" href="#identity-1">Identity</a></h2>
<ul>
<li><strong>Name</strong>: Message Source Account or MSA</li>
<li><strong>Docs</strong>: <a href="https://libertydsnp.github.io/frequency/pallet_msa/index.html"><code>MSA Pallet</code></a></li>
<li><strong>Representation</strong>:
The following data that constitute a Message Source Account are stored in the MSA pallet:
<ul>
<li>The DSNP User Id associated with this MSA</li>
<li>Delegation relationships to Providers</li>
<li>Schema permissions granted to Providers</li>
<li>MSA user state (Profile, Graph, etc...)</li>
<li><a href="Frequency/Identity.html#control-keys">Control keys</a></li>
</ul>
</li>
</ul>
<h2 id="dsnp-user-identifier"><a class="header" href="#dsnp-user-identifier">DSNP User Identifier</a></h2>
<ul>
<li><strong>Name</strong>: Message Source Account Identifier, or MSA Id.</li>
<li><strong>Data Type</strong>: <code>uint64</code></li>
<li><strong>Docs</strong>: <a href="https://libertydsnp.github.io/frequency/common_primitives/msa/type.MessageSourceId.html"><code>MessageSourceId</code></a></li>
<li><strong>Mapping</strong>: The MSA Id is able to be used directly as the DSNP User Id</li>
<li><strong>Description</strong>:
At least one public key MUST be associated with an MSA Id for it to be considered active.</li>
</ul>
<h2 id="control-keys"><a class="header" href="#control-keys">Control Keys</a></h2>
<ul>
<li><strong>Name</strong>: Referred to as: <code>public_key</code>, <code>provider_key</code>, or <code>delegator_key</code></li>
<li><strong>Data Type</strong>: <code>AccountId</code>, Schnorrkel/Ristretto X25519 (&quot;sr25519&quot;) derived cryptographic public key</li>
<li><strong>Docs</strong>: <a href="https://libertydsnp.github.io/frequency/common_primitives/node/type.AccountId.html"><code>AccountId</code></a></li>
<li><strong>Description</strong>: See <a href="https://wiki.polkadot.network/docs/learn-cryptography">Cryptography on Polkadot</a> and <a href="https://spec.polkadot.network/#defn-account-key">Polkadot Protocol Specification</a>.
A public key CANNOT be associated with more than one MSA at a time.</li>
</ul>
<h2 id="delegation-1"><a class="header" href="#delegation-1">Delegation</a></h2>
<ul>
<li><strong>Name</strong>: <code>delegation</code></li>
<li><strong>Docs</strong>: <a href="https://libertydsnp.github.io/frequency/pallet_msa/types/struct.Delegation.html"><code>Delegation</code></a></li>
<li><strong>Representation</strong>:
The following data storage relates necessary information for retrieving and validating delegations:
<ul>
<li>Provider registry</li>
<li>Delegations</li>
<li>Schema permissions granted to Providers</li>
</ul>
</li>
</ul>
<h3 id="user"><a class="header" href="#user">User</a></h3>
<ul>
<li><strong>Name</strong>: Delegator</li>
<li><strong>Representation</strong>: MSA Id</li>
</ul>
<h3 id="delegate"><a class="header" href="#delegate">Delegate</a></h3>
<ul>
<li><strong>Name</strong>: Provider</li>
<li><strong>Representation</strong>: MSA Id</li>
<li><strong>Description</strong>:
A Provider MUST already have an MSA Id (via <code>msa::create()</code>) and be approved as a Provider (via <code>msa::propose_to_be_provider()</code>).</li>
</ul>
<h2 id="related-operations-2"><a class="header" href="#related-operations-2">Related Operations</a></h2>
<ul>
<li><a href="Frequency/Operations.html#create-identifier">Create Identifier</a></li>
<li><a href="Frequency/Operations.html#retire-identifier">Retire Identifier</a></li>
<li><a href="Frequency/Operations.html#define-delegation">Define Delegation</a></li>
<li><a href="Frequency/Operations.html#revoke-delegation">Revoke Delegation</a></li>
<li><a href="Frequency/Operations.html#add-control-key">Add Control Key</a></li>
<li><a href="Frequency/Operations.html#remove-control-key">Remove Control Key</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="announcement-publishing"><a class="header" href="#announcement-publishing">Announcement Publishing</a></h1>
<p>On Frequency, <a href="Frequency/../DSNP/Announcements.html">Announcements</a> are mapped to Schemas which in turn publish Frequency Messages or Stateful Storage changes.
Frequency Messages are either individual Announcements from a particular user, or a Batch Publication with a multitude of possible users.
Frequency Stateful Storage is either direct Announcements from a particular user or <a href="Frequency/./UserData.html">User Data</a> changes.</p>
<!-- Links to https://libertydsnp.github.io/frequency should be updated with links to docs.frequency.xyz when able to be -->
<!-- Update ./Overview.md if a Schema Id is updated  -->
<div class="table-wrapper"><table><thead><tr><th>Announcement Type Enum</th><th>Announcement</th><th>Type</th><th>Schema Id Mainnet</th><th>Schema Id Rococo</th><th>Frequency Model Type</th><th>Frequency Payload Location</th></tr></thead><tbody>
<tr><td>0</td><td><a href="Frequency/../DSNP/Types/Tombstone.html">Tombstone</a></td><td>Batched</td><td>1</td><td>1</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>2</td><td><a href="Frequency/../DSNP/Types/Broadcast.html">Broadcast</a></td><td>Batched</td><td>2</td><td>2</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>3</td><td><a href="Frequency/../DSNP/Types/Reply.html">Reply</a></td><td>Batched</td><td>3</td><td>3</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>4</td><td><a href="Frequency/../DSNP/Types/Reaction.html">Reaction</a></td><td>Batched</td><td>4</td><td>4</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>5</td><td><a href="Frequency/../DSNP/Types/Profile.html">Profile</a></td><td>Batched</td><td>6</td><td>5</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>6</td><td><a href="Frequency/../DSNP/Types/Update.html">Update</a></td><td>Batched</td><td>5</td><td>6</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.Parquet"><code>Parquet</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.IPFS"><code>IPFS</code></a></td></tr>
<tr><td>7</td><td><a href="Frequency/../DSNP/Types/PublicKey.html">Public Key</a></td><td><a href="Frequency/./UserData.html#announcements">Stateful</a></td><td>TBD</td><td>18</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.AvroBinary"><code>AvroBinary</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.Itemized"><code>Itemized</code></a></td></tr>
</tbody></table>
</div>
<p>Source code for each schema is located in the <a href="https://github.com/LibertyDSNP/schemas">LibertyDSNP/schemas</a> repository.</p>
<h2 id="batch-publications-1"><a class="header" href="#batch-publications-1">Batch Publications</a></h2>
<p>Frequency uses <a href="Frequency/../DSNP/BatchPublications.html">DSNP Batch Publications</a> for some types of Announcements.
Parquet files are stored on <a href="https://ipfs.io/">IPFS</a>, but are discovered through Frequency Messages.</p>
<p>DSNP Batch Publications <a href="Frequency/./Validation.html">MUST be validated</a> upon fetching to ensure data and permission integrity.</p>
<h2 id="announcement-validation-1"><a class="header" href="#announcement-validation-1">Announcement Validation</a></h2>
<p>DSNP Announcements are validated differently depending on the type of Announcement.
Non-batched Announcements are on chain, are validated at write time, and do not need to be re-validated at read time.
Batched Announcements are off chain and MUST be validated at read time (See: <a href="Frequency/./Validation.html">Validation</a>).</p>
<h2 id="ordering-announcements-1"><a class="header" href="#ordering-announcements-1">Ordering Announcements</a></h2>
<p>Frequency Messages are well ordered:</p>
<ol>
<li>Frequency: Block number ascending</li>
<li>Frequency: Block index ascending (unique)</li>
<li>DSNP Standard: Order Announcements in a Batch Publication File by row appearance order.</li>
</ol>
<h3 id="human-order"><a class="header" href="#human-order">Human Order</a></h3>
<p>Due to the asynchronous nature of networks and batching, it is possible that the canonical ordering of Announcements is wrong from a human viewpoint.
With dependent Announcements, where one Announcement refers to another Announcement, the order may be inferred differently than the canonical ordering.
It is left to user interfaces to handle these situations.</p>
<h2 id="retrieval"><a class="header" href="#retrieval">Retrieval</a></h2>
<p>Frequency nodes provide an RPC interface <a href="https://libertydsnp.github.io/frequency/pallet_messages_rpc/trait.MessagesApiClient.html#method.get_messages_by_schema"><code>messages.getBySchemaId()</code></a> with paginated responses that differ based on the Schema.</p>
<p>Frequency nodes can provide a websocket interface that will emit an event for each block that has one or more messages of a given schema in that block.
The <a href="https://libertydsnp.github.io/frequency/pallet_messages/pallet/enum.Event.html#variant.MessagesStored"><code>messages::MessagesStored</code></a> event can be used to know when to call the RPC interface to retrieve the messages.</p>
<p>See the <a href="https://libertydsnp.github.io/frequency/pallet_messages_rpc/trait.MessagesApiClient.html#method.get_messages_by_schema">Frequency Documentation</a> for more details on Message retrieval.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="batch-publication-validation"><a class="header" href="#batch-publication-validation">Batch Publication Validation</a></h1>
<!-- Links to https://libertydsnp.github.io/frequency should be updated with links to docs.frequency.xyz when able to be -->
<p>The <a href="https://libertydsnp.github.io/frequency/common_primitives/messages/struct.MessageResponse.html">Frequency Message</a> for a Batch Publication has several important fields for validation:</p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody>
<tr><td><code>provider_msa_id</code></td><td>MSA Id of the provider sending the message</td></tr>
<tr><td><code>cid</code></td><td>The <a href="https://github.com/multiformats/cid/">Content IDentifier v1</a> for IPFS content</td></tr>
<tr><td><code>payload_length</code></td><td>Expected length of the content from IPFS</td></tr>
<tr><td><code>block_number</code></td><td>Block number that the message was recorded on the chain.</td></tr>
</tbody></table>
</div>
<h2 id="file-validation"><a class="header" href="#file-validation">File Validation</a></h2>
<ol>
<li>Retrieve the file from the IPFS network using the <code>cid</code>.</li>
<li>Verify the file hash by <a href="https://docs.ipfs.tech/concepts/hashing/">comparing it to the hash included in the <code>cid</code></a>. (Required for non-trusted IPFS nodes.)</li>
<li>Verify that the byte length of the retrieved file matches the <code>payload_length</code>.</li>
</ol>
<h2 id="publication-announcements-validation"><a class="header" href="#publication-announcements-validation">Publication Announcements Validation</a></h2>
<ol>
<li>Collect the unique set of <code>fromId</code> values.</li>
<li>Use the <a href="https://libertydsnp.github.io/frequency/pallet_msa_rpc/trait.MsaApiClient.html#method.check_delegations">Custom RPC <code>msa.checkDelegations()</code></a> with the <code>fromId</code> values as the <code>delegator_msa_ids</code> and the <code>provider_msa_id</code> at the <code>block_number</code>.</li>
<li>The <code>fromId</code> values that <code>msa.checkDelegations()</code> verifies as having a delegation at <code>block_number</code> are valid Announcements.</li>
<li>Set the <code>schema_id</code> parameter to the Schema Id used in the Frequency Message</li>
</ol>
<h2 id="announcement-duplicates"><a class="header" href="#announcement-duplicates">Announcement Duplicates</a></h2>
<p>Duplicate Announcements MUST be rejected or ignored.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operations-1"><a class="header" href="#operations-1">Operations</a></h1>
<h2 id="method-of-execution"><a class="header" href="#method-of-execution">Method of execution</a></h2>
<p>DSNP Operations are executed on Frequency via on-chain transactions, also known as extrinsic calls.
An extrinsic is a type of function defined in a <a href="https://substrate.io/">Substrate</a> Pallet.
A Pallet is a Substrate runtime module and also a Cargo crate.</p>
<h3 id="msa-pallet"><a class="header" href="#msa-pallet">MSA Pallet</a></h3>
<p>Responsible for DSNP Identity Operations and Delegation management.</p>
<h3 id="schema-pallet"><a class="header" href="#schema-pallet">Schema Pallet</a></h3>
<p>Responsible for managing the data structures for DSNP Announcements and User Data.</p>
<h3 id="messages-pallet"><a class="header" href="#messages-pallet">Messages Pallet</a></h3>
<p>Responsible for most DSNP Announcement Operations (see <a href="Frequency/./Publishing.html">Publishing</a>).</p>
<h3 id="stateful-storage-pallet"><a class="header" href="#stateful-storage-pallet">Stateful Storage Pallet</a></h3>
<p>Responsible for DSNP User Data (see <a href="Frequency/./UserData.html">User Data</a>) and select Announcement Operations (see <a href="Frequency/./Publishing.html">Publishing</a>).</p>
<h3 id="documentation-links"><a class="header" href="#documentation-links">Documentation Links</a></h3>
<ul>
<li><a href="https://docs.frequency.xyz">Frequency Documentation</a></li>
<li><a href="https://libertydsnp.github.io/frequency">Frequency Rust Documentation</a></li>
</ul>
<h2 id="principals"><a class="header" href="#principals">Principals</a></h2>
<p>Every Frequency transaction for DSNP is accompanied by an Schnorrkel/Ristretto X25519 (&quot;sr25519&quot;) derived cryptographic signature and associated public key.
When the transaction occurs, the signature is validated and the <a href="Frequency/./Identity.html#identity">MSA Id</a> is retrieved.</p>
<div class="table-wrapper"><table><thead><tr><th>DSNP Term</th><th>Frequency Term</th></tr></thead><tbody>
<tr><td>User</td><td><a href="Frequency/./Identity.html#user">User / Delegator</a></td></tr>
<tr><td>Delegate</td><td><a href="Frequency/./Identity.html#delegate">Provider</a></td></tr>
</tbody></table>
</div>
<h2 id="failure-handling-1"><a class="header" href="#failure-handling-1">Failure Handling</a></h2>
<p>Frequency has a variety of errors that fall into these classes:</p>
<ul>
<li>Timeout: A transaction with an unknown status after a set time.</li>
<li>Node Rejection: Public nodes may reject transactions from unknown parties.</li>
<li>Node Validation Error: A node will reject malformed or invalid transactions when possible.</li>
<li>Execution Error: A transaction that was included in a block but failed upon execution.</li>
</ul>
<p>Transactions are not automatically resubmitted.
Check with the <a href="https://docs.frequency.xyz">Frequency Documentation</a> for more information regarding errors.</p>
<h2 id="list-of-operations-1"><a class="header" href="#list-of-operations-1">List of Operations</a></h2>
<p>Write operations are via Transactions (also called Extrinsics): <code>pallet::extrinsic()</code></p>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Principal(s)</th><th>Pallet::Extrinsic</th><th>State Change Record</th></tr></thead><tbody>
<tr><td><a id="create-identifier">Create Identifier</a></td><td>None</td><td><a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.create"><code>msa::create()</code></a>, <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.create_sponsored_account_with_delegation"><code>msa::create_sponsored_account_with_delegation()</code></a></td><td><a href="Frequency/Records.html#identifier-creation">Identifier Creation Record</a></td></tr>
<tr><td><a id="retire-identifier">Retire Identifier</a></td><td>User</td><td><a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.retire_msa"><code>msa::retire_msa()</code></a></td><td><a href="Frequency/Records.html#identifier-retirement">Identifier Retirement Record</a></td></tr>
<tr><td><a id="define-delegation">Define Delegation</a></td><td>User AND Delegate</td><td><a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.grant_delegation"><code>msa::grant_delegation()</code></a>, <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.create_sponsored_account_with_delegation"><code>msa::create_sponsored_account_with_delegation()</code></a></td><td><a href="Frequency/Records.html#delegation-definition">Delegation Definition Record</a></td></tr>
<tr><td><a id="revoke-delegation">Revoke Delegation</a></td><td>User</td><td><a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.revoke_delegation_by_delegator"><code>msa::revoke_delegation_by_delegator()</code></a></td><td><a href="Frequency/Records.html#delegation-revocation">Delegation Revocation Record</a></td></tr>
<tr><td><a id="revoke-delegation">Revoke Delegation</a></td><td>Delegate</td><td><a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.revoke_delegation_by_provider"><code>msa::revoke_delegation_by_provider()</code></a></td><td><a href="Frequency/Records.html#delegation-revocation">Delegation Revocation Record</a></td></tr>
<tr><td><a id="add-control-key">Add Control Key</a></td><td>User</td><td><a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.add_public_key_to_msa"><code>msa::add_public_key_to_msa()</code></a></td><td><a href="Frequency/Records.html#control-key-addition">Control Key Addition Record</a></td></tr>
<tr><td><a id="remove-control-key">Remove Control Key</a></td><td>User</td><td><a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Call.html#variant.delete_msa_public_key"><code>msa::delete_msa_public_key()</code></a></td><td><a href="Frequency/Records.html#control-key-removal">Control Key Removal Record</a></td></tr>
<tr><td><a id="publish-announcement">Publish Announcement</a></td><td>User OR Delegate</td><td><a href="https://libertydsnp.github.io/frequency/pallet_messages/pallet/enum.Call.html#variant.add_onchain_message"><code>messages::add_onchain_message()</code></a></td><td><a href="Frequency/Records.html#announcement-published">Announcement Published Record</a></td></tr>
<tr><td><a id="publish-batch">Publish Batch</a></td><td>User OR Delegate</td><td><a href="https://libertydsnp.github.io/frequency/pallet_messages/pallet/enum.Call.html#variant.add_ipfs_message"><code>messages::add_ipfs_message()</code></a></td><td><a href="Frequency/Records.html#batch-published">Batch Published Record</a></td></tr>
<tr><td><a id="get-user-data">Get User Data</a></td><td>Any</td><td>See <a href="Frequency/./UserData.html#read-operation-mapping">User Data: Read Operation Mapping</a></td><td>-</td></tr>
<tr><td><a id="replace-user-data">Replace User Data</a></td><td>User OR Delegate</td><td>See <a href="Frequency/./UserData.html#write-operation-mapping">User Data: Write Operation Mapping</a></td><td><a href="Frequency/Records.html#user-data-replaced">User Data Replaced Record</a></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="state-change-records-1"><a class="header" href="#state-change-records-1">State Change Records</a></h1>
<p>State Change Records constitute the observable output of a DSNP system.
Frequency uses a combination of on chain data to store and Events to notify for Records.</p>
<h2 id="frequency-transaction-identifier"><a class="header" href="#frequency-transaction-identifier">Frequency Transaction Identifier</a></h2>
<p>Frequency uses the hash of the <a href="Frequency/Operations.html">Operation</a> transaction to then request a node report the transaction status and any Events related to that hash.
(Client libraries usually have this built in.)</p>
<h2 id="frequency-records"><a class="header" href="#frequency-records">Frequency Records</a></h2>
<p>Frequency produces three types of data that map or point to DSNP Records.</p>
<h3 id="events"><a class="header" href="#events">Events</a></h3>
<p>Events are generated on each block and may contain a pointer to the Record data instead of the entire Record.</p>
<p>Events are referenced by <code>pallet::EventName</code>.</p>
<h3 id="messages"><a class="header" href="#messages">Messages</a></h3>
<p>Frequency Messages store Announcements or Batch Publication Records.
It uses the <a href="https://libertydsnp.github.io/frequency/pallet_messages/">Messages Pallet</a>.</p>
<p>Messages are retrieved via state queries (<code>pallet.stateQuery</code>) or RPC calls (<code>pallet.rpcCall()</code>).</p>
<h3 id="state"><a class="header" href="#state">State</a></h3>
<p>Frequency State stores data associated with an <a href="Frequency/Identity.html">Identity</a>.
It can also be used to look up the state of prior Records related to an Identity.</p>
<p>State data is retrieved via state queries (<code>pallet.stateQuery</code>) or RPC calls (<code>pallet.rpcCall()</code>).</p>
<h2 id="record-mappings"><a class="header" href="#record-mappings">Record Mappings</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Record Type</th><th>Record Pointer/Location</th></tr></thead><tbody>
<tr><td><a id="identifier-creation">Identifier Creation Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Event.html#variant.MsaCreated"><code>msa::MsaCreated</code></a><br/>State: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/type.PublicKeyToMsaId.html"><code>msa.publicKeyToMsaId</code></a></td></tr>
<tr><td><a id="identifier-retirement">Identifier Retirement Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Event.html#variant.MsaRetired"><code>msa::MsaRetired</code></a></td></tr>
<tr><td><a id="delegation-definition">Delegation Definition Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Event.html#variant.DelegationGranted"><code>msa::DelegationGranted</code></a>, <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Event.html#variant.DelegationUpdated"><code>msa::DelegationUpdated</code></a><br />RPC: <a href="https://libertydsnp.github.io/frequency/pallet_msa_rpc/trait.MsaApiClient.html#method.check_delegations"><code>msa.checkDelegations()</code></a>, <a href="https://libertydsnp.github.io/frequency/pallet_msa_rpc/trait.MsaApiServer.html#tymethod.get_granted_schemas_by_msa_id"><code>msa.getGrantedSchemasByMsaId()</code></a></td></tr>
<tr><td><a id="delegation-revocation">Delegation Revocation Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Event.html#variant.DelegationRevoked"><code>msa::DelegationRevoked</code></a><br />RPC: <a href="https://libertydsnp.github.io/frequency/pallet_msa_rpc/trait.MsaApiClient.html#method.check_delegations"><code>msa.checkDelegations()</code></a></td></tr>
<tr><td><a id="control-key-addition">Control Key Addition Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Event.html#variant.PublicKeyAdded"><code>msa::PublicKeyAdded</code></a><br />State: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/type.PublicKeyToMsaId.html"><code>msa.publicKeyToMsaId</code></a></td></tr>
<tr><td><a id="control-key-removal">Control Key Removal Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/enum.Event.html#variant.PublicKeyDeleted"><code>msa::PublicKeyDeleted</code></a><br />State: <a href="https://libertydsnp.github.io/frequency/pallet_msa/pallet/type.PublicKeyToMsaId.html"><code>msa.publicKeyToMsaId</code></a></td></tr>
<tr><td><a id="announcement-published">Announcement Published Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_messages/pallet/enum.Event.html#variant.MessagesStored"><code>messages::MessagesStored</code></a><br />RPC: <a href="https://libertydsnp.github.io/frequency/pallet_messages_rpc/trait.MessagesApiServer.html#tymethod.get_messages_by_schema_id"><code>messages.getBySchemaId()</code></a></td></tr>
<tr><td><a id="batch-published">Batch Published Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_messages/pallet/enum.Event.html#variant.MessagesStored"><code>messages::MessagesStored</code></a><br />RPC: <a href="https://libertydsnp.github.io/frequency/pallet_messages_rpc/trait.MessagesApiServer.html#tymethod.get_messages_by_schema_id"><code>messages.getBySchemaId()</code></a></td></tr>
<tr><td><a id="failure">Failure Record</a></td><td>See section on <a href="Frequency/./Operations.html#failure-handling">Failure Handling</a></td></tr>
<tr><td><a id="user-data-replaced">User Data Replaced Record</a></td><td>Event: <a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Event.html#variant.ItemizedPageUpdated"><code>stateful_storage::ItemizedPageUpdated</code></a>, <a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Event.html#variant.ItemizedPageDeleted"><code>stateful_storage::ItemizedPageDeleted</code></a>, <a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Event.html#variant.PaginatedPageUpdated"><code>stateful_storage::PaginatedPageUpdated</code></a>, <a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Event.html#variant.PaginatedPageDeleted"><code>stateful_storage::PaginatedPageDeleted</code></a><br />RPC: <a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage_rpc/trait.StatefulStorageApiServer.html#tymethod.get_paginated_storage"><code>statefulStorage.getPaginatedStorage()</code></a>, <a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage_rpc/trait.StatefulStorageApiServer.html#tymethod.get_itemized_storage"><code>statefulStorage.getItemizedStorage()</code></a><br />See Also: <a href="Frequency/./UserData.html#read-operation-mapping">Read User Data</a></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="frequency-user-data"><a class="header" href="#frequency-user-data">Frequency User Data</a></h1>
<p>On Frequency, User Data and select Announcements are mapped to Schemas which use <a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/index.html">Stateful Storage</a> for storage and retrieval of the data.</p>
<h2 id="user-data-sets"><a class="header" href="#user-data-sets">User Data Sets</a></h2>
<!-- Update ./Overview.md if a Schema Id is updated  -->
<div class="table-wrapper"><table><thead><tr><th>User Data Set</th><th>Schema Id Mainnet</th><th>Schema Id Rococo</th><th>Frequency Model Type</th><th>Frequency Payload Location</th><th>Settings</th></tr></thead><tbody>
<tr><td><a href="Frequency/../DSNP/Graph.html#public-follows">Public Follows</a></td><td>TBD</td><td>13</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.AvroBinary"><code>AvroBinary</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.Paginated"><code>Paginated</code></a></td><td>None</td></tr>
<tr><td><a href="Frequency/../DSNP/Graph.html#private-follows">Private Follows</a></td><td>TBD</td><td>14</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.AvroBinary"><code>AvroBinary</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.Paginated"><code>Paginated</code></a></td><td>None</td></tr>
<tr><td><a href="Frequency/../DSNP/Graph.html#private-connections">Private Connections</a></td><td>TBD</td><td>15</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.AvroBinary"><code>AvroBinary</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.Paginated"><code>Paginated</code></a></td><td>None</td></tr>
</tbody></table>
</div>
<p><a href="Frequency/./../DSNP/Graph.html#pseudonymous-relationship-identifiers">Pseudonymous Relationship Identifiers</a> (PRIds) are stored along side Private Connections in the same Stateful Storage page.</p>
<p>Source code for each schema is located in the <a href="https://github.com/LibertyDSNP/schemas">LibertyDSNP/schemas</a> repository.</p>
<h2 id="announcements"><a class="header" href="#announcements">Announcements</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Announcement</th><th>Schema Id Mainnet</th><th>Schema Id Rococo</th><th>Frequency Model Type</th><th>Frequency Payload Location</th><th>Settings</th></tr></thead><tbody>
<tr><td><a href="Frequency/../DSNP/Types/PublicKey.html">Public Key</a></td><td>TBD</td><td>7 (<em>v1.3.0+</em>)</td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.ModelType.html#variant.AvroBinary"><code>AvroBinary</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.PayloadLocation.html#variant.Itemized"><code>Itemized</code></a></td><td><a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.SchemaSetting.html#variant.AppendOnly">Append Only</a>, <a href="https://libertydsnp.github.io/frequency/common_primitives/schema/enum.SchemaSetting.html#variant.SignatureRequired">Signature Required</a></td></tr>
</tbody></table>
</div>
<h2 id="read-operation-mapping"><a class="header" href="#read-operation-mapping">Read Operation Mapping</a></h2>
<p>Stateful data is retrieved via state queries (<code>pallet.stateQuery</code>) or RPC calls (<code>pallet.rpcCall()</code>).</p>
<div class="table-wrapper"><table><thead><tr><th>Model Type</th><th>DSNP Properties</th><th>Query/Call</th></tr></thead><tbody>
<tr><td>Itemized</td><td>Entity Tag</td><td><a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage_rpc/trait.StatefulStorageApiClient.html#method.get_itemized_storage"><code>stateful_storage.getItemizedStorage()</code></a></td></tr>
<tr><td>Paginated</td><td>Entity Tag, Chunked</td><td><a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage_rpc/trait.StatefulStorageApiClient.html#method.get_paginated_storage"><code>stateful_storage.getPaginatedStorage()</code></a></td></tr>
</tbody></table>
</div>
<h2 id="write-operation-mapping"><a class="header" href="#write-operation-mapping">Write Operation Mapping</a></h2>
<p>Write operations are via Transactions (also called Extrinsics): <code>pallet::extrinsic()</code></p>
<div class="table-wrapper"><table><thead><tr><th>Model Type</th><th>Operation</th><th>Pallet::Extrinsic</th></tr></thead><tbody>
<tr><td>Itemized</td><td>Insert, Update, Delete</td><td><a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Call.html#variant.apply_item_actions"><code>stateful_storage::apply_item_actions()</code></a><br/><a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Call.html#variant.apply_item_actions_with_signature"><code>stateful_storage::apply_item_actions_with_signature()</code></a></td></tr>
<tr><td>Paginated</td><td>Insert, Update</td><td><a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Call.html#variant.upsert_page"><code>stateful_storage::upsert_page()</code></a><br/><a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Call.html#variant.upsert_page_with_signature"><code>stateful_storage::upsert_page_with_signature()</code></a></td></tr>
<tr><td>Paginated</td><td>Delete</td><td><a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Call.html#variant.delete_page"><code>stateful_storage::delete_page()</code></a><br/><a href="https://libertydsnp.github.io/frequency/pallet_stateful_storage/pallet/enum.Call.html#variant.delete_page_with_signature"><code>stateful_storage::delete_page_with_signature()</code></a></td></tr>
</tbody></table>
</div>
<h3 id="entity-tags-1"><a class="header" href="#entity-tags-1">Entity Tags</a></h3>
<p>Frequency requires the hash of current state for any Stateful Storage change.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="activity-content-specification"><a class="header" href="#activity-content-specification">Activity Content Specification</a></h1>
<p><strong>Version 1.2.0</strong></p>
<p>Content references shared via the DSNP consist of URLs pointing to documents containing Activity Streams JSON objects.
For the purposes of the DSNP, restrictions are placed on the <a href="https://www.w3.org/TR/activitystreams-core/">Activity Streams 2.0</a> specification.</p>
<h2 id="json-ld-and-activity-streams"><a class="header" href="#json-ld-and-activity-streams">JSON-LD and Activity Streams</a></h2>
<p>All DSNP Activity Content is compatible with the <a href="https://www.w3.org/TR/activitystreams-core/">Activity Streams 2.0</a> specification.
While there are some DSNP extensions, they are guaranteed to use non-colliding terms.
Therefore, the JSON-LD <code>@context</code> field is set to <code>https://www.w3.org/ns/activitystreams</code> according to <a href="https://www.w3.org/TR/activitystreams-core/#jsonld">Activity Streams 2.0 §2.1</a>.</p>
<h2 id="core-activity-content-types"><a class="header" href="#core-activity-content-types">Core Activity Content Types</a></h2>
<p>DSNP uses only the following content types at the root level:</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Description</th><th>DSNP Announcements</th></tr></thead><tbody>
<tr><td><a href="ActivityContent/Types/Note.html">Note</a></td><td>standard user content</td><td><a href="ActivityContent/../DSNP/Types/Broadcast.html">Broadcast</a>, <a href="ActivityContent/../DSNP/Types/Reply.html">Reply</a></td></tr>
<tr><td><a href="ActivityContent/Types/Profile.html">Profile</a></td><td>user profile content</td><td><a href="ActivityContent/../DSNP/Types/Profile.html">Profile</a></td></tr>
</tbody></table>
</div>
<h2 id="associated-types"><a class="header" href="#associated-types">Associated Types</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Description</th><th>Specification</th></tr></thead><tbody>
<tr><td><a href="ActivityContent/Associated/Location.html">Location</a></td><td>add a location to content</td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/">Activity Vocabulary</a></td></tr>
<tr><td><a href="ActivityContent/Associated/Tag.html">Tag</a></td><td>add a tag to content</td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/">Activity Vocabulary</a></td></tr>
<tr><td><a href="ActivityContent/Associated/Attachments.html">Attachments</a></td><td>supported attachment types</td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/">Activity Vocabulary</a></td></tr>
<tr><td><a href="ActivityContent/Associated/Hash.html">Hash</a></td><td>content validation hash</td><td>DSNP Extension</td></tr>
</tbody></table>
</div>
<h2 id="supported-url-schema"><a class="header" href="#supported-url-schema">Supported URL Schema</a></h2>
<p>URLs in DSNP-compatible Activity Content MUST use one of the following URL schemes:</p>
<div class="table-wrapper"><table><thead><tr><th>Scheme</th><th>Description</th><th>Reference</th><th>DSNP Version Added</th></tr></thead><tbody>
<tr><td>HTTPS</td><td>Hypertext Transfer Protocol Secure</td><td><a href="https://datatracker.ietf.org/doc/html/rfc2818">RFC2818</a></td><td>1.0</td></tr>
<tr><td>HTTP</td><td>Hypertext Transfer Protocol</td><td><a href="https://datatracker.ietf.org/doc/html/rfc2616">RFC2616</a></td><td>1.0</td></tr>
</tbody></table>
</div>
<h2 id="libraries"><a class="header" href="#libraries">Libraries</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Language(s)</th></tr></thead><tbody>
<tr><td><a href="https://github.com/LibertyDSNP/activity-content">LibertyDSNP/activity-content</a></td><td>JavaScript/TypeScript</td></tr>
<tr><td><a href="https://github.com/LibertyDSNP/activity-content-java">LibertyDSNP/activity-content-java</a></td><td>Java/Kotlin</td></tr>
<tr><td><a href="https://github.com/LibertyDSNP/activity-content-swift">LibertyDSNP/activity-content-swift</a></td><td>Swift</td></tr>
</tbody></table>
</div><!--- Uncomment for pre-release changes and prefix the version with `pre-[next version]`
## Prerelease Changelog
--->
<h2 id="releases-1"><a class="header" href="#releases-1">Releases</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Description</th><th>Release Date</th><th>Changelog</th></tr></thead><tbody>
<tr><td><a href="https://github.com/LibertyDSNP/spec/tree/ActivityContent-v1.2.0">1.2.0</a></td><td>DIP-210</td><td>2023-04-11</td><td><a href="https://github.com/LibertyDSNP/spec/releases/tag/ActivityContent-v1.2.0">Changelog</a></td></tr>
<tr><td><a href="https://github.com/LibertyDSNP/spec/tree/ActivityContent-v1.1.0">1.1.0</a></td><td>DIP-158</td><td>2022-05-05</td><td><a href="https://github.com/LibertyDSNP/spec/releases/tag/ActivityContent-v1.1.0">Changelog</a></td></tr>
<tr><td><a href="https://github.com/LibertyDSNP/spec/tree/ActivityContent-v1.0.0">1.0.0</a></td><td>Initial Release</td><td>2021-09-09</td><td><a href="https://github.com/LibertyDSNP/spec/releases/tag/ActivityContent-v1.0.0">Changelog</a></td></tr>
</tbody></table>
</div>
<h2 id="non-normative-6"><a class="header" href="#non-normative-6">Non-Normative</a></h2>
<h2 id="additional-fields"><a class="header" href="#additional-fields">Additional Fields</a></h2>
<p>Implementers may choose to support more of the Activity Streams standard as long as it does not conflict with this specification, but should note that other implementations may not recognize those additions.
Implementers who extend their support for Activity Streams objects beyond the subset defined here do so at their own risk.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="activity-stream-type-note"><a class="header" href="#activity-stream-type-note">Activity Stream Type: Note</a></h1>
<p><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-note">Activity Vocabulary: Note</a></p>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>@context</code></td><td><a href="https://www.w3.org/TR/activitystreams-core/#jsonld">Activity Streams 2.0</a></td><td>YES</td><td>JSON-LD @context</td><td>MUST be set to <code>https://www.w3.org/ns/activitystreams</code></td></tr>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Note</code></td></tr>
<tr><td><code>content</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-content">Activity Vocabulary 2.0</a></td><td>YES</td><td>Text content of the note</td><td></td></tr>
<tr><td><code>mediaType</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-mediatype">Activity Vocabulary 2.0</a></td><td>YES</td><td>MIME type for the <code>content</code> field</td><td>MUST be set to a <a href="ActivityContent/Types/Note.html#supported-content-mime-types">supported MIME type</a></td></tr>
<tr><td><code>published</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-published">Activity Vocabulary 2.0</a></td><td>YES</td><td>The time of publishing</td><td>MUST be <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO8601</a></td></tr>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>no</td><td>The display name for the note</td><td></td></tr>
<tr><td><code>attachment</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-attachment">Activity Vocabulary 2.0</a></td><td>no</td><td>Array of attached links or media</td><td>MUST be one of the <a href="ActivityContent/Types/../Associated/Attachments.html">Supported Attachments</a></td></tr>
<tr><td><code>tag</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-tag">Activity Vocabulary 2.0</a></td><td>no</td><td>Array of tags/mentions</td><td>MUST follow <a href="ActivityContent/Types/../Associated/Tag.html">Tag Type</a></td></tr>
<tr><td><code>location</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-location">Activity Vocabulary 2.0</a></td><td>no</td><td>For location</td><td>MUST follow <a href="ActivityContent/Types/../Associated/Location.html">Location Type</a></td></tr>
</tbody></table>
</div>
<h2 id="supported-content-mime-types"><a class="header" href="#supported-content-mime-types">Supported Content MIME Types</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Format</th><th>MIME Type</th><th>Specification(s)</th></tr></thead><tbody>
<tr><td>Plain</td><td><code>text/plain</code></td><td></td></tr>
</tbody></table>
</div>
<h2 id="examples-3"><a class="header" href="#examples-3">Examples</a></h2>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;content&quot;: &quot;Hello world!&quot;,
  &quot;mediaType&quot;: &quot;text/plain&quot;,
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;content&quot;: &quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&quot;,
  &quot;mediaType&quot;: &quot;text/plain&quot;,
  &quot;summary&quot;: &quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&quot;,
  &quot;attachment&quot;: [
    {
      &quot;type&quot;: &quot;Link&quot;,
      &quot;href&quot;: &quot;https://en.wikipedia.org/wiki/Citation_needed&quot;
    }
  ],
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="activity-stream-type-profile"><a class="header" href="#activity-stream-type-profile">Activity Stream Type: Profile</a></h1>
<p>Profiles are used to provide additional user information display.</p>
<p><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-profile">Activity Vocabulary: Profile</a></p>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>@context</code></td><td><a href="https://www.w3.org/TR/activitystreams-core/#jsonld">Activity Streams 2.0</a></td><td>YES</td><td>JSON-LD @context</td><td>MUST be set to <code>https://www.w3.org/ns/activitystreams</code></td></tr>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Profile</code></td></tr>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>no</td><td>The display name for the profile</td><td></td></tr>
<tr><td><code>icon</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-icon">Activity Vocabulary 2.0</a></td><td>no</td><td>An array of avatars of the profile</td><td>MUST follow <a href="ActivityContent/Types/../Associated/Attachments.html#image-link">Image Link Type</a></td></tr>
<tr><td><code>summary</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-summary">Activity Vocabulary 2.0</a></td><td>no</td><td>Used as a plain text biography of the profile</td><td></td></tr>
<tr><td><code>published</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-published">Activity Vocabulary 2.0</a></td><td>no</td><td>The time of publishing</td><td>MUST be <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO8601</a></td></tr>
<tr><td><code>location</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-location">Activity Vocabulary 2.0</a></td><td>no</td><td>For location</td><td>MUST follow <a href="ActivityContent/Types/../Associated/Location.html">Location Type</a></td></tr>
<tr><td><code>tag</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-tag">Activity Vocabulary 2.0</a></td><td>no</td><td>For tags or mentions</td><td>MUST follow <a href="ActivityContent/Types/../Associated/Tag.html">Tag Type</a></td></tr>
</tbody></table>
</div>
<h2 id="examples-4"><a class="header" href="#examples-4">Examples</a></h2>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Profile&quot;,
  &quot;name&quot;: &quot;John Doe&quot;,
  &quot;summary&quot;: &quot;John Doe is actually a small kitten. See pfp.&quot;,
  &quot;icon&quot;: [
    {
      &quot;type&quot;: &quot;Link&quot;,
      &quot;href&quot;: &quot;https://placekitten.com/256/256&quot;,
      &quot;mediaType&quot;: &quot;image/jpeg&quot;,
      &quot;width&quot;: &quot;256&quot;,
      &quot;height&quot;: &quot;256&quot;,
      &quot;hash&quot;: [
        &quot;QmVmUqGYtHcVgpTFR64bHNcLGGFEeWxmUP6pV2C2RbWpKT&quot;
      ]
    },
    {
      &quot;type&quot;: &quot;Link&quot;,
      &quot;href&quot;: &quot;https://placekitten.com/64/64&quot;,
      &quot;mediaType&quot;: &quot;image/jpeg&quot;,
      &quot;width&quot;: &quot;64&quot;,
      &quot;height&quot;: &quot;64&quot;,
      &quot;hash&quot;: [
        &quot;QmcAh1rov5GcddekCffGeRnaSyiji6ATmfGWpxXYJHgJZx&quot;
      ]
    }
  ],
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="associated-type-hash"><a class="header" href="#associated-type-hash">Associated Type: Hash</a></h1>
<p><em>NOT</em> part of the Activity Streams 2.0 Vocabulary.</p>
<p>Activity objects linking to external content such as audio, image or video files must include a <code>&quot;hash&quot;</code> field for users to validate linked content.
The value of this <code>&quot;hash&quot;</code> field must be an array of strings, each representing a hash output using a specific algorithm.
AT LEAST ONE hash in the array MUST be one of the <a href="ActivityContent/Associated/Hash.html#supported-algorithms">supported algorithms</a>, although others may also be used.</p>
<p>Hashes MUST be encoded using the <a href="https://github.com/multiformats/multihash">multihash</a> specification, and serialized as a <a href="https://github.com/multiformats/multibase">multibase</a> string.</p>
<h3 id="supported-algorithms"><a class="header" href="#supported-algorithms">Supported Algorithms</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Algorithm</th><th>Multihash Name</th><th>Leading bytes (as <a href="https://github.com/multiformats/unsigned-varint">varint</a>)</th><th>Reference</th><th>DSNP Version Added</th></tr></thead><tbody>
<tr><td>SHA-256</td><td><code>sha2-256</code></td><td><code>0x1220</code></td><td><a href="https://tools.ietf.org/html/rfc6234">RFC 6234</a></td><td>1.2.0</td></tr>
<tr><td>BLAKE2b</td><td><code>blake2b-256</code></td><td><code>0xa0e40220</code></td><td><a href="https://tools.ietf.org/html/rfc7693">RFC 7693</a></td><td>1.2.0</td></tr>
</tbody></table>
</div>
<h3 id="example-2"><a class="header" href="#example-2">Example</a></h3>
<p>This example gives SHA-256 and BLAKE2b hashes for the <a href="https://github.com/LibertyDSNP/papers/raw/main/whitepaper/dsnp_whitepaper.pdf">PDF version of the DSNP whitepaper</a>.</p>
<pre><code class="language-json">{
  &quot;hash&quot;: [
    &quot;QmQNHNfHnbgJJ6nK4UPx2VtTUCafAKCbqZJ6ZRYUGjoeFj&quot;,
    &quot;2DrjgbGgSsXRhTiBWckoVwBFC6H4qiBWWNumSsRwdUt82YnTdN&quot;
  ]
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="associated-type-location"><a class="header" href="#associated-type-location">Associated Type: Location</a></h1>
<p><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-location">Activity Vocabulary: location</a></p>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Place</code></td></tr>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>YES</td><td>The display name for the location</td><td></td></tr>
<tr><td><code>accuracy</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-accuracy">Activity Vocabulary 2.0</a></td><td>no</td><td>The accuracy of the coordinates as a percentage. (e.g. &quot;94.0&quot; means &quot;94.0% accurate&quot;)</td><td></td></tr>
<tr><td><code>altitude</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-altitude">Activity Vocabulary 2.0</a></td><td>no</td><td>The altitude of the location</td><td></td></tr>
<tr><td><code>latitude</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-latitude">Activity Vocabulary 2.0</a></td><td>no</td><td>The latitude of the location</td><td></td></tr>
<tr><td><code>longitude</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-longitude">Activity Vocabulary 2.0</a></td><td>no</td><td>The longitude of the location</td><td></td></tr>
<tr><td><code>radius</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-radius">Activity Vocabulary 2.0</a></td><td>no</td><td>The area around the given point that comprises the location</td><td></td></tr>
<tr><td><code>units</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-units">Activity Vocabulary 2.0</a></td><td>no</td><td>The units for <code>radius</code> and <code>altitude</code> (defaults to meters)</td><td>MUST be one of these: <code>cm</code>, <code>feet</code>, <code>inches</code>, <code>km</code>, <code>m</code>, <code>miles</code></td></tr>
</tbody></table>
</div>
<h2 id="warning"><a class="header" href="#warning">Warning</a></h2>
<p>Location data may pose a privacy danger to users.
Users should be warned before publishing location data.</p>
<h2 id="example-3"><a class="header" href="#example-3">Example</a></h2>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;content&quot;: &quot;I'm in NYC!&quot;,
  &quot;mediaType&quot;: &quot;text/plain&quot;,
  &quot;location&quot;: {
    &quot;type&quot;: &quot;Place&quot;,
    &quot;name&quot;: &quot;New York City, NY&quot;,
    &quot;latitude&quot;: &quot;40.73&quot;,
    &quot;longitude&quot;: &quot;-73.93&quot;,
    &quot;accuracy&quot;: &quot;94.0&quot;
  },
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="associated-type-tag"><a class="header" href="#associated-type-tag">Associated Type: Tag</a></h1>
<p><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-tag">Activity Vocabulary: tag</a></p>
<h2 id="hashtag"><a class="header" href="#hashtag">Hashtag</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>YES</td><td>The text of the tag</td><td></td></tr>
</tbody></table>
</div>
<h3 id="example-4"><a class="header" href="#example-4">Example</a></h3>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;content&quot;: &quot;I love the #dsnp spec!&quot;,
  &quot;mediaType&quot;: &quot;text/plain&quot;,
  &quot;tag&quot;: [
    {
      &quot;name&quot;: &quot;#dsnp&quot;
    }
  ],
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<h2 id="mention"><a class="header" href="#mention">Mention</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>no</td><td>The text of the tag</td><td></td></tr>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the tag as type <code>Mention</code></td><td>MUST be <code>Mention</code></td></tr>
<tr><td><code>id</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-id">Activity Vocabulary 2.0</a></td><td>YES</td><td>Link to the user mentioned</td><td>MUST be a <a href="ActivityContent/Associated/../../DSNP/Identifiers.html#dsnp-user-uri">DSNP User URI</a></td></tr>
</tbody></table>
</div>
<h3 id="example-5"><a class="header" href="#example-5">Example</a></h3>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;content&quot;: &quot;@sally should check out the #dsnp spec!&quot;,
  &quot;mediaType&quot;: &quot;text/plain&quot;,
  &quot;tag&quot;: [
    {
      &quot;name&quot;: &quot;#dsnp&quot;
    },
    {
      &quot;name&quot;: &quot;@sally&quot;,
      &quot;type&quot;: &quot;Mention&quot;,
      &quot;id&quot;: &quot;dsnp://0x12345678&quot;
    }
  ],
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="associated-attachments"><a class="header" href="#associated-attachments">Associated Attachments</a></h1>
<h2 id="audio"><a class="header" href="#audio">Audio</a></h2>
<p><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-audio">Activity Vocabulary: Audio</a></p>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Audio</code></td></tr>
<tr><td><code>url</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-url">Activity Vocabulary 2.0</a></td><td>YES</td><td>An array of links for given audio content in different formats</td><td>MUST be an <a href="ActivityContent/Associated/Attachments.html#audio-link">Audio Link</a> AND MUST have at least one <a href="ActivityContent/Associated/Attachments.html#supported-audio-mime-types">supported audio MIME type</a></td></tr>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>no</td><td>The display name for the audio file</td><td></td></tr>
<tr><td><code>duration</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-duration">Activity Vocabulary 2.0</a></td><td>no</td><td>Approximate <a href="https://www.w3.org/TR/xmlschema11-2/#duration">duration</a> of the audio</td><td></td></tr>
</tbody></table>
</div>
<h3 id="audio-link"><a class="header" href="#audio-link">Audio Link</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Link</code></td></tr>
<tr><td><code>href</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-href">Activity Vocabulary 2.0</a></td><td>YES</td><td>The URL for the given audio content</td><td>MUST be a <a href="ActivityContent/Associated/../Overview.html#supported-url-schema">Supported URL Schema</a></td></tr>
<tr><td><code>mediaType</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-mediatype">Activity Vocabulary 2.0</a></td><td>YES</td><td>MIME type of <code>href</code> content</td><td>MUST follow</td></tr>
<tr><td><code>hash</code></td><td><a href="ActivityContent/Associated/Hash.html">DSNP 1.0</a></td><td>YES</td><td>Array of hashes for linked content validation</td><td>MUST include at least one <a href="ActivityContent/Associated/Hash.html#supported-algorithms">supported hash</a></td></tr>
</tbody></table>
</div>
<h3 id="supported-audio-mime-types"><a class="header" href="#supported-audio-mime-types">Supported Audio MIME Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Format</th><th>MIME Type</th><th>Specification(s)</th></tr></thead><tbody>
<tr><td>MP3</td><td><code>audio/mpeg</code></td><td><a href="https://tools.ietf.org/html/rfc3003">RFC3003</a></td></tr>
<tr><td>OGG</td><td><code>audio/ogg</code></td><td><a href="https://tools.ietf.org/html/rfc5334">RFC5334</a></td></tr>
<tr><td>WebM</td><td><code>audio/webm</code></td><td><a href="https://www.webmproject.org/docs/container/">WebM standard</a></td></tr>
</tbody></table>
</div>
<h3 id="example-6"><a class="header" href="#example-6">Example</a></h3>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;attachments&quot;: [
    {
      &quot;type&quot;: &quot;Audio&quot;,
      &quot;name&quot;: &quot;The Scream&quot;,
      &quot;url&quot;: [
        {
          &quot;type&quot;: &quot;Link&quot;,
          &quot;href&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/d/d9/Wilhelm_Scream.ogg&quot;,
          &quot;mediaType&quot;: &quot;audio/ogg&quot;,
          &quot;hash&quot;: [
		    &quot;QmQrGdv6Ky5sJhaVdw27y4aod5pdfihDkBTxiBkRaSGJJ7&quot;
          ]
        }
      ],
      &quot;duration&quot;: &quot;1S&quot;
    }
  ],
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<h2 id="image"><a class="header" href="#image">Image</a></h2>
<p><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-image">Activity Vocabulary: Image</a></p>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Image</code></td></tr>
<tr><td><code>url</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-url">Activity Vocabulary 2.0</a></td><td>YES</td><td>An array of links for given image content in different formats</td><td>MUST be an <a href="ActivityContent/Associated/Attachments.html#image-link">Image Link</a> AND MUST have at least one <a href="ActivityContent/Associated/Attachments.html#supported-image-mime-types">supported image MIME type</a></td></tr>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>no</td><td>The display name or alt text for the image</td><td></td></tr>
</tbody></table>
</div>
<h3 id="image-link"><a class="header" href="#image-link">Image Link</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Link</code></td></tr>
<tr><td><code>href</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-href">Activity Vocabulary 2.0</a></td><td>YES</td><td>The URL for the given image</td><td>MUST be a <a href="ActivityContent/Associated/../Overview.html#supported-url-schema">Supported URL Schema</a></td></tr>
<tr><td><code>mediaType</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-mediatype">Activity Vocabulary 2.0</a></td><td>YES</td><td>MIME type of <code>href</code> content</td><td></td></tr>
<tr><td><code>hash</code></td><td><a href="ActivityContent/Associated/Hash.html">DSNP 1.0</a></td><td>YES</td><td>Array of hashes for linked content validation</td><td>MUST include at least one <a href="ActivityContent/Associated/Hash.html#supported-algorithms">supported hash</a></td></tr>
<tr><td><code>height</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-height">Activity Vocabulary 2.0</a></td><td>no</td><td>A hint as to the rendering height in device-independent pixels</td><td></td></tr>
<tr><td><code>width</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-width">Activity Vocabulary 2.0</a></td><td>no</td><td>A hint as to the rendering width in device-independent pixels</td><td></td></tr>
</tbody></table>
</div>
<h3 id="supported-image-mime-types"><a class="header" href="#supported-image-mime-types">Supported Image MIME Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Format</th><th>MIME Type</th><th>Specification(s)</th></tr></thead><tbody>
<tr><td>JPEG</td><td><code>image/jpeg</code></td><td><a href="https://www.iana.org/go/rfc2045">RFC2045</a></td></tr>
<tr><td>PNG</td><td><code>image/png</code></td><td><a href="https://www.w3.org/TR/2003/REC-PNG-20031110/">W3C PNG Standard</a></td></tr>
<tr><td>SVG</td><td><code>image/svg+xml</code></td><td><a href="https://www.w3.org/Graphics/SVG/">W3C SVG standard</a></td></tr>
<tr><td>WebP</td><td><code>image/webp</code></td><td><a href="https://developers.google.com/speed/webp/">WebP standard</a></td></tr>
<tr><td>GIF</td><td><code>image/gif</code></td><td><a href="https://www.iana.org/go/rfc2045">RFC2045</a></td></tr>
</tbody></table>
</div>
<h3 id="example-7"><a class="header" href="#example-7">Example</a></h3>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;attachments&quot;: [
    {
      &quot;type&quot;: &quot;Image&quot;,
      &quot;name&quot;: &quot;One of the founders of DSNP&quot;,
      &quot;url&quot;: [
        {
          &quot;type&quot;: &quot;Link&quot;,
          &quot;href&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/a/ae/Mccourt.jpg&quot;,
          &quot;width&quot;: 350,
          &quot;height&quot;: 228,
          &quot;mediaType&quot;: &quot;image/jpg&quot;,
          &quot;hash&quot;: [
            &quot;2Drjgb5yoVWTpubcWmDBLJqkxrFkZamekzJoYLSWwM2ezpFkab&quot;
          ]
        }
      ]
    }
  ],
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<h2 id="video"><a class="header" href="#video">Video</a></h2>
<p><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-video">Activity Vocabulary: Video</a></p>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Video</code></td></tr>
<tr><td><code>url</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-url">Activity Vocabulary 2.0</a></td><td>YES</td><td>An array of links for given video content in different formats</td><td>MUST be a <a href="ActivityContent/Associated/Attachments.html#video-link">Video Link</a> AND MUST have at least one <a href="ActivityContent/Associated/Attachments.html#supported-video-mime-types">supported video MIME type</a></td></tr>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>no</td><td>The display name for the video</td><td></td></tr>
<tr><td><code>duration</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-duration">Activity Vocabulary 2.0</a></td><td>no</td><td>Approximate <a href="https://www.w3.org/TR/xmlschema11-2/#duration">duration</a> of the video</td><td></td></tr>
</tbody></table>
</div>
<h3 id="video-link"><a class="header" href="#video-link">Video Link</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Link</code></td></tr>
<tr><td><code>href</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-href">Activity Vocabulary 2.0</a></td><td>YES</td><td>The URL for the given content</td><td>MUST be a <a href="ActivityContent/Associated/../Overview.html#supported-url-schema">Supported URL Schema</a></td></tr>
<tr><td><code>mediaType</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-mediatype">Activity Vocabulary 2.0</a></td><td>YES</td><td>MIME type of <code>href</code> content</td><td></td></tr>
<tr><td><code>hash</code></td><td><a href="ActivityContent/Associated/Hash.html">DSNP 1.0</a></td><td>YES</td><td>Array of hashes for linked content validation</td><td>MUST include at least one <a href="ActivityContent/Associated/Hash.html#supported-algorithms">supported hash</a></td></tr>
<tr><td><code>height</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-height">Activity Vocabulary 2.0</a></td><td>no</td><td>A hint as to the rendering height in device-independent pixels</td><td></td></tr>
<tr><td><code>width</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-width">Activity Vocabulary 2.0</a></td><td>no</td><td>A hint as to the rendering width in device-independent pixels</td><td></td></tr>
</tbody></table>
</div>
<h3 id="supported-video-mime-types"><a class="header" href="#supported-video-mime-types">Supported Video MIME Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Format</th><th>MIME Type</th><th>Specification(s)</th></tr></thead><tbody>
<tr><td>MPEG</td><td><code>video/mpeg</code></td><td><a href="https://www.iana.org/go/rfc2045">RFC2045</a></td></tr>
<tr><td>OGG</td><td><code>video/ogg</code></td><td><a href="https://www.iana.org/go/rfc5334">RFC5334</a></td></tr>
<tr><td>WebM</td><td><code>video/webm</code></td><td><a href="https://www.webmproject.org/docs/container/">WebM standard</a></td></tr>
<tr><td>H265</td><td><code>video/H265</code></td><td><a href="https://www.iana.org/go/rfc7798">RFC7798</a></td></tr>
<tr><td>MP4</td><td><code>video/mp4</code></td><td><a href="https://www.iana.org/go/rfc4337">RFC4337</a></td></tr>
</tbody></table>
</div>
<h3 id="example-8"><a class="header" href="#example-8">Example</a></h3>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;attachments&quot;: [
    {
      &quot;type&quot;: &quot;Video&quot;,
      &quot;name&quot;: &quot;One of the founders of DSNP&quot;,
      &quot;duration&quot;: &quot;PT10M32S&quot;,
      &quot;url&quot;: [
        {
          &quot;type&quot;: &quot;Link&quot;,
          &quot;href&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/c/c0/Big_Buck_Bunny_4K.webm&quot;,
          &quot;width&quot;: 4000,
          &quot;height&quot;: 2250,
          &quot;mediaType&quot;: &quot;video/webm&quot;,
          &quot;hash&quot;: [
            &quot;2Drjgb4a8eC4XheBKCBcbAcaVdEWcKjMbCSZ2L2c9CQs4x98jf&quot;
          ]
        }
      ]
    }
  ],
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<h2 id="link"><a class="header" href="#link">Link</a></h2>
<p><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-link">Activity Vocabulary: Link</a></p>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Base Spec</th><th>Required</th><th>Description</th><th>Restrictions</th></tr></thead><tbody>
<tr><td><code>type</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-type">Activity Vocabulary 2.0</a></td><td>YES</td><td>Identifies the type of the object</td><td>MUST be set to <code>Link</code></td></tr>
<tr><td><code>href</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-href">Activity Vocabulary 2.0</a></td><td>YES</td><td>The URL for the given link</td><td>MUST be a <a href="ActivityContent/Associated/../Overview.html#supported-url-schema">Supported URL Schema</a></td></tr>
<tr><td><code>name</code></td><td><a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-name">Activity Vocabulary 2.0</a></td><td>no</td><td>The display name for the link</td><td></td></tr>
</tbody></table>
</div>
<h3 id="examples-5"><a class="header" href="#examples-5">Examples</a></h3>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;content&quot;: &quot;Check out the DSNP Website!&quot;,
  &quot;mediaType&quot;: &quot;text/plain&quot;,
  &quot;attachment&quot;: [
    {
      &quot;type&quot;: &quot;Link&quot;,
      &quot;name&quot;: &quot;DSNP Website&quot;,
      &quot;href&quot;: &quot;https://dsnp.org&quot;
    }
  ],
  &quot;published&quot;: &quot;1970-01-01T00:00:00+00:00&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="glossary"><a class="header" href="#glossary">Glossary</a></h1>
<ul>
<li><strong>Activity Content</strong> - The linked content connected to an &quot;Announcement&quot;</li>
<li><strong>Announcement</strong> - An item of data, typically an image or note, posted to the blockchain via a &quot;Batch Publication&quot;</li>
<li><strong>Bad actor</strong> - A user intentionally using the application for bad-faith or illegal purposes</li>
<li><strong>Batch Publication</strong> - A collection of Announcements</li>
<li><strong>Bot</strong> - An automated account, sometimes malicious but often providing some service (&quot;Hey Alexa, what's the weather?&quot;)</li>
<li><strong>Consumer</strong> - Someone who reads content from social media</li>
<li><strong>Contract address</strong> - The unique number associated with a smart contract posted on the blockchain</li>
<li><strong>Hash Collision</strong> - The vanishingly unlikely possibility of a hash providing the same output for two different inputs</li>
<li><strong>Hash function</strong> - A cryptographic function whose output is effectively unique for any given input without any information from the input being accessible in the output</li>
<li><strong>Hash</strong> - A string of characters generated from a hash function, see &quot;Hash function&quot;</li>
<li><strong>Identity Contract</strong> - The smart contract used to store a user's delegated public addresses and permissions, see &quot;Contract address&quot;</li>
<li><strong>Publisher</strong> - The contract that posts new content from a publisher to the blockchain through batch publications</li>
<li><strong>Store</strong> - A means of keeping messages or data for an extended period of time</li>
<li><strong>User</strong> - A human using our application. <a href="https://time.com/4008832/17-dogs-to-follow-on-instagram/">See article for an exception</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
