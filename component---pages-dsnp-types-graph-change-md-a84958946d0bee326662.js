(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{xKvI:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return c})),a.d(t,"default",(function(){return d}));var n=a("Fcif"),l=a("+I+c"),r=(a("mXGw"),a("/FXl")),b=a("TjRS"),i=(a("aD51"),["components"]),c={};void 0!==c&&c&&c===Object(c)&&Object.isExtensible(c)&&!Object.prototype.hasOwnProperty.call(c,"__filemeta")&&Object.defineProperty(c,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"pages/DSNP/Types/GraphChange.md"}});var p={_frontmatter:c},o=b.a;function d(e){var t=e.components,a=Object(l.a)(e,i);return Object(r.b)(o,Object(n.a)({},p,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"graph-change-announcement"},"Graph Change Announcement"),Object(r.b)("p",null,"A Graph Change Announcement is for publishing relationship state changes for a user."),Object(r.b)("h2",{id:"fields"},"Fields"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",{parentName:"tr",align:null},"Field"),Object(r.b)("th",{parentName:"tr",align:null},"Description"),Object(r.b)("th",{parentName:"tr",align:null},"Data Type"),Object(r.b)("th",{parentName:"tr",align:null},"Serialization"),Object(r.b)("th",{parentName:"tr",align:null},"Parquet Type"),Object(r.b)("th",{parentName:"tr",align:null},"Bloom Filter"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"announcementType"),Object(r.b)("td",{parentName:"tr",align:null},"Announcement Type Enum (",Object(r.b)("inlineCode",{parentName:"td"},"1"),")"),Object(r.b)("td",{parentName:"tr",align:null},"enum"),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("a",{parentName:"td",href:"/DSNP/Serializations#decimal"},"decimal")),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("inlineCode",{parentName:"td"},"INT32")),Object(r.b)("td",{parentName:"tr",align:null},"no")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"changeType"),Object(r.b)("td",{parentName:"tr",align:null},"Type of relationship change"),Object(r.b)("td",{parentName:"tr",align:null},"enum"),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("a",{parentName:"td",href:"/DSNP/Serializations#decimal"},"decimal")),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("inlineCode",{parentName:"td"},"INT32")),Object(r.b)("td",{parentName:"tr",align:null},"no")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"createdAt"),Object(r.b)("td",{parentName:"tr",align:null},"milliseconds since Unix epoch"),Object(r.b)("td",{parentName:"tr",align:null},"64 bit unsigned integer"),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("a",{parentName:"td",href:"/DSNP/Serializations#decimal"},"decimal")),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("inlineCode",{parentName:"td"},"UINT_64")),Object(r.b)("td",{parentName:"tr",align:null},"no")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"fromId"),Object(r.b)("td",{parentName:"tr",align:null},"id of the user creating the relationship"),Object(r.b)("td",{parentName:"tr",align:null},"64 bit unsigned integer"),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("a",{parentName:"td",href:"/DSNP/Serializations#decimal"},"decimal")),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("inlineCode",{parentName:"td"},"UINT_64")),Object(r.b)("td",{parentName:"tr",align:null},"YES")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"objectId"),Object(r.b)("td",{parentName:"tr",align:null},"id of the target of the relationship"),Object(r.b)("td",{parentName:"tr",align:null},"64 bit unsigned integer"),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("a",{parentName:"td",href:"/DSNP/Serializations#decimal"},"decimal")),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("inlineCode",{parentName:"td"},"UINT_64")),Object(r.b)("td",{parentName:"tr",align:null},"YES")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"signature"),Object(r.b)("td",{parentName:"tr",align:null},"creator signature"),Object(r.b)("td",{parentName:"tr",align:null},"65 bytes"),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("a",{parentName:"td",href:"/DSNP/Serializations#hexadecimal"},"hexadecimal")),Object(r.b)("td",{parentName:"tr",align:null},Object(r.b)("inlineCode",{parentName:"td"},"BYTE_ARRAY")),Object(r.b)("td",{parentName:"tr",align:null},"no")))),Object(r.b)("h2",{id:"field-requirements"},"Field Requirements"),Object(r.b)("h3",{id:"announcementtype"},"announcementType"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"MUST be fixed to ",Object(r.b)("inlineCode",{parentName:"li"},"1"))),Object(r.b)("h3",{id:"changetype"},"changeType"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"MUST be one of the Change Type Enum")),Object(r.b)("h3",{id:"change-type-enum"},"Change Type Enum"),Object(r.b)("p",null,"Different change types have different meanings"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",{parentName:"tr",align:null},"Value"),Object(r.b)("th",{parentName:"tr",align:null},"Name"),Object(r.b)("th",{parentName:"tr",align:null},"Description"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"0"),Object(r.b)("td",{parentName:"tr",align:null},"Unfollow"),Object(r.b)("td",{parentName:"tr",align:null},"Remove a Follow relationship")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"1"),Object(r.b)("td",{parentName:"tr",align:null},"Follow"),Object(r.b)("td",{parentName:"tr",align:null},"Create a Follow relationship")))),Object(r.b)("h3",{id:"createdat"},"createdAt"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"MUST be set to the milliseconds since Unix epoch at time of signing"),Object(r.b)("li",{parentName:"ul"},"MUST be unique for the given ",Object(r.b)("inlineCode",{parentName:"li"},"fromId")," and ",Object(r.b)("inlineCode",{parentName:"li"},"objectId")," pair")),Object(r.b)("h3",{id:"fromid"},"fromId"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"MUST be a ",Object(r.b)("a",{parentName:"li",href:"/DSNP/Identifiers#dsnp-user-id"},"DSNP User Id")),Object(r.b)("li",{parentName:"ul"},"MUST be the ",Object(r.b)("a",{parentName:"li",href:"/DSNP/Signatures"},"signer")," of the announcement")),Object(r.b)("h3",{id:"objectid"},"objectId"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"MUST be a ",Object(r.b)("a",{parentName:"li",href:"/DSNP/Identifiers#dsnp-user-id"},"DSNP User Id"))),Object(r.b)("h3",{id:"signature"},"signature"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"MUST be an ",Object(r.b)("a",{parentName:"li",href:"/DSNP/Signatures"},"Announcement Signature")," over the all fields except the signature field")),Object(r.b)("h2",{id:"non-normative"},"Non-Normative"),Object(r.b)("h3",{id:"replay-attacks"},"Replay Attacks"),Object(r.b)("p",null,"Clients must ignore any Graph Change event that comes after another event with the same signature.\nThis avoids ",Object(r.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Replay_attack"},"Replay attacks"),"\nEach graph change event has a ",Object(r.b)("inlineCode",{parentName:"p"},"createAt")," that allows for differing signatures.\nThe ",Object(r.b)("inlineCode",{parentName:"p"},"createAt")," is set to the timestamp is represented as milliseconds since Unix epoch."),Object(r.b)("p",null,"For example:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},'Bob "follows" Charlie and then "unfollows" him then "follows" him again.')),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"If the ",Object(r.b)("inlineCode",{parentName:"li"},"GraphChange")," event has no timestamp, the second follow event would have to be ignored when reading the graph.\nIt would appear to have the same signature as the first event and therefore be a duplicate, and a potential replay attack."),Object(r.b)("li",{parentName:"ul"},"With a timestamp, the second follow event would have a unique signature and could therefore be interpreted as a valid event.")),Object(r.b)("h3",{id:"graph-retrieval-ordering--reading"},"Graph Retrieval, Ordering & Reading"),Object(r.b)("p",null,"Each graph change event represents a state transition for the graph.\nThe state of the graph at any time is given by taking the state of the graph at a previous time and applying all graph change events not previously applied in the order specified above.\nOnce those graph change events are retrieved, they can be ordered to reflect the current graph state\n(i.e. Charlie has followed Bob then unfollowed him and then followed him again. The graph state reflects that Charlie is Following Bob)."),Object(r.b)("p",null,"To retrieve the graph, do the following:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Retrieve the ",Object(r.b)("a",{parentName:"li",href:"/BatchPublication/Publish"},Object(r.b)("inlineCode",{parentName:"a"},"DSNPBatchPublications"))," events with ",Object(r.b)("a",{parentName:"li",href:"/DSNP/Announcements#announcement-types"},"announcementType"),' matching the enum for "Graph Change" from the chain.'),Object(r.b)("li",{parentName:"ol"},"Retrieve the batch files from each log event."),Object(r.b)("li",{parentName:"ol"},"Query the batch files for the data for a particular DSNP User Id to retrieve information about the respective graph."),Object(r.b)("li",{parentName:"ol"},"Order the retrieved data by ",Object(r.b)("a",{parentName:"li",href:"/DSNP/Announcements#ordering-announcements"},"Announcement Ordering"))))}void 0!==d&&d&&d===Object(d)&&Object.isExtensible(d)&&!Object.prototype.hasOwnProperty.call(d,"__filemeta")&&Object.defineProperty(d,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"pages/DSNP/Types/GraphChange.md"}}),d.isMDXComponent=!0}}]);
//# sourceMappingURL=component---pages-dsnp-types-graph-change-md-a84958946d0bee326662.js.map